
+++
date = "2018-04-17 11:41:52 +0000 UTC"
draft = false
title = "PowerShell：陸上自衛隊のイラク派遣日報をまとめてダウンロードする"
tags = ["PowerShell"]

+++
```ps1
$source = "https://www.asahi.com/articles/ASL4J669JL4JUEHF016.html"
$folder = "C:\Users\Hideto\pdf"

$result = Invoke-WebRequest $source -UseBasicParsing
$urls = $result.Links.href | Get-Unique |  where { $_ -match ".pdf" }

foreach ($url in $urls)
{
    $file = ($url  -split "/")[-1]
    Invoke-WebRequest -Uri $url -OutFile (Join-Path $folder $file)
}

```{{< figure src="/images/20180417114019.png"  >}}結構量があるんだなぁ……（終わらねぇ。文学作品として割と楽しめるらしいので、ダウンロードが終わるの楽しみ☆（ゝω・）vｷｬﾋﾟそれはともかく、PowerShell、もっとうまく、サクッと書けるようになりたいなぁ。

<div class="section">
    ### 元ネタ
    >イラク日報ぶっこ抜きスターターパック$ curl https://t.co/nt7h0I8NpE | grep &#39;&#39; | grep pdf | awk -F&#39;"&#39; &#39;{print $4}&#39; | xargs wget— opensorter (@opensorter) 2018年4月16日<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><br/>


</div>
<div class="section">
    ### 追伸
    {{< figure src="/images/20180417163143.png"  >}}ナメてたけど、結構量が多かった。ダウンロード中のファイルを一つ開いちゃって、ダウンロードに失敗したにもかかわらずこんなにデカくなったぞ……。

</div>

