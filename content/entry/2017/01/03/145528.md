
+++
date = "2017-01-03 14:55:28 +0000 UTC"
draft = false
title = "「三重県民には無理に飲ませてはいけない」をグラフ化する"
tags = ["とりとめもないこと","Microsoft Excel","Google","三重"]

+++

<div class="section">
    ### Excel の 3D Maps を利用する
    詳しい方法は「<a href="https://dekiru.net/article/13655/">Excel 2016の新機能「3Dマップ」の使い方。地図上にグラフを作成できる！ | できるネット</a>」で紹介されている。

{{< figure src="/images/20170103144302.png"  >}}

ずテーブルを作成。

{{< figure src="/images/20170103144402.png"  >}}

に［挿入］－［3D マップ］コマンドを選択。

{{< figure src="/images/20170103144439.png"  >}}

データ解析アドイン」を有効化するかどうか聞かれるので、［有効］ボタンを押す。

{{< figure src="/images/20170103144529.png"  >}}

ると 3D Maps の編集画面が現れるので、ごにょごにょイジっていい感じにする。なんか塗りが適当だし、石川県・香川県・福岡県がなぜか欠落しているけど気にしない（詳しい人、直し方教えて）。

</div>
<div class="section">
    ### Google Chart を利用する
    JavaScript が書けるならこっちの方が簡単。
```javascript
&lt;script src="https://www.google.com/jsapi">&lt;/script>
&lt;script>
google.load(&#39;visualization&#39;, &#39;1&#39;, {packages:[&#39;geochart&#39;]});
google.setOnLoadCallback(graphChart);

function graphChart() {
  var data = google.visualization.arrayToDataTable([
    ["都道府県", "データ"], 
    ["秋田",  76.7]  ,
    ：
    ：
    ["三重",  39.7]  
  ]);
  var option = {
    region: &#39;JP&#39;,
    resolution: &#39;provinces&#39;
  };

  var chart = new google.visualization
      .GeoChart(document.getElementById(&#39;chart&#39;));
  chart.draw(data, option);
}
&lt;/script>

&lt;div id="chart">&lt;/div

>

```コードを貼り付けると、以下のようにレンダリングされる。<script src="https://www.google.com/jsapi"></script>

<br/

>
<script>
google.load('visualization', '1', {packages:['geochart']});
google.setOnLoadCallback(graphChart);

function graphChart() {
  var data = google.visualization.arrayToDataTable([
    ["都道府県", "データ"], 
    ["秋田",  76.7]  ,
    ["岩手",  71.4]  ,
    ["鹿児島",  71.4],
    ["福島",  70.4]  ,
    ["埼玉",  65.4]  ,
    ["山形",  65.1]  ,
    ["北海道",  64.8],
    ["沖縄",  64.8]  ,
    ["熊本",  64.3]  ,
    ["高知",  64.0]  ,
    ["千葉",  63.4]  ,
    ["青森",  63.2]  ,
    ["宮城",  63.2]  ,
    ["新潟",  62.4]  ,
    ["神奈川",  61.9],
    ["香川",  61.6]  ,
    ["大分",  60.2]  ,
    ["宮崎",  60.2]  ,
    ["東京",  60.0]  ,
    ["栃木",  59.8]  ,
    ["茨城",  59.3]  ,
    ["山梨",  59.3]  ,
    ["長野",  58.5]  ,
    ["福井",  58.5]  ,
    ["鳥取",  58.5]  ,
    ["島根",  58.5]  ,
    ["愛媛",  58.5]  ,
    ["兵庫",  57.8]  ,
    ["福岡",  57.8]  ,
    ["静岡",  57.2]  ,
    ["山口",  56.3]  ,
    ["佐賀",  56.3]  ,
    ["長崎",  56.3]  ,
    ["徳島",  56.0]  ,
    ["滋賀",  55.8]  ,
    ["京都",  55.5]  ,
    ["群馬",  54.8]  ,
    ["富山",  54.8]  ,
    ["岡山",  53.8]  ,
    ["奈良",  53.3]  ,
    ["大阪",  53.0]  ,
    ["広島",  52.4]  ,
    ["和歌山",  49.7],
    ["岐阜",  47.6]  ,
    ["石川",  45.7]  ,
    ["愛知",  41.4]  ,
    ["三重",  39.7]  
  ]);
  var option = {
    region: 'JP',
    resolution: 'provinces'
  };

  var chart = new google.visualization
      .GeoChart(document.getElementById('chart'));
  chart.draw(data, option);
}
</script>

<div id="chart"></div>ちなみに、下記の記事を参照しました。都道府県名に“県”とかつけちゃうとダメみたい。[GoogleChartsのGeochartで都道府県分布マップを簡単作成 - Qiita](http://qiita.com/sue738/items/3297c79e62be1cb799c1)<br/>


</div>
<div class="section">
    ### 雑感
    東海地方はお酒が弱い人が多いみたい。なんとなくだけど記紀によく登場する地域（紀・畿内・吉備・越＋東海）はお酒に弱い感じがあるので、縄文系はお酒に強く、弥生系はお酒に弱いみたいな違いとかあるのかな。

</div>

