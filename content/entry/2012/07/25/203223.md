
+++
date = "2012-07-25 20:32:23 +0000 UTC"
draft = false
title = "失敗の数だけ強くなりたい（ Jason.NET についての補足"
tags = ["C#"]

+++


{{< figure src="/images/20120725203328.png"  >}}

a href="https://blog.daruyanagi.jp/entry/2012/07/24/201150">失敗の数だけ強くなりたい - だるろぐ</a> の補足。
```
"files": {
    "close_duplicate_tab.js": {
        "type": "application/javascript",
        "filename": "close_duplicate_tab.js",
        "raw_url": "https://gist.github.com/raw/3175551/c7590ad8cfdd352150a8c845ff96fb9f30bd3a65/close_duplicate_tab.js",
        "language": "JavaScript",
        "size": 1465
    }
}
```この Json は Dictionary&lt;string, File> でうけることになるのだけど、 File を最初以下のとおりに定義していた。
```cs
public struct File
{
    public string @type;
    public string filename;
    public string raw_url;
    public string language;
    public string size;
}

```これでもいいのだけれど、フィールドはビューへバインディングできないのでプロパティにした、というのは前回に言った<a href="#f-1abcc75c" name="fn-1abcc75c" title="type の前に @ をつけるのは、 type が予約語であるため。アクセスする場合は File.type でよい">*1</a>。
```cs
public struct File
{
    public string @type { get; set; }
    public string filename { get; set; }
    public string raw_url { get; set; }
    public string language { get; set; }
    public string size { get; set; }
}

```これでうまくいったのだけれど……うっかり struct を class にしてなかった。それでも動くんだな…… struct でもプロパティ持てるの？<a href="#f-1fd0fe34" name="fn-1fd0fe34" title="持てるらしい！　struct はメンバ関数をもてるので、プロパティがプライベートメンバ変数およびそのセッター・ゲッターの糖衣構文だと考えれば、別にできてもおかしくはないということかなぁ。教えて、エロいひと！">*2</a>　よくわからなくなってくる。ここでは値を渡すことはないし、のちのち面倒くさいことになったら嫌なので class にしておいたほうが無難かな。まぁ、それは置いておこう。次に気になるのは、プロパティが Snake Case になっていること。やっぱり Pascal Case にしておきたい。試してみたところ<a href="#f-2b14458a" name="fn-2b14458a" title="ドキュメント読めよ">*3</a>、 Jason.NET でデシリアライズするときには大文字と小文字が区別されないようなので、先頭を大文字にしてもいいようだ。
```cs
public class File
{
    public string @Type { get; set; }
    public string Filename { get; set; }
    public string Raw_Url { get; set; }
    public string Language { get; set; }
    public string Size { get; set; }
}

```しかし、これでも Raw_Url のようにアンダーバーが残ってしまう。 Snake Case を勝手に Pascal Case のフィールド・プロパティへ割り当ててくれないかなぁ、とほのかに期待していたのだけれど、そこまではやってくれないみたい<a href="#f-82a71e39" name="fn-82a71e39" title="Ruby on Rails ならやってくれただろう">*4</a>。そんなときは、 JasonProperty 属性を利用すればよいようだ。
```cs
public class File
{
    public string @Type { get; set; }
    public string Filename { get; set; }
    [JsonProperty("raw_url")]
    public string RawUrl { get; set; }
    public string Language { get; set; }
    public string Size { get; set; }
}

```それだけ。
<div class="footnote">
<a href="#fn-1abcc75c" name="f-1abcc75c" class="footnote-number">*1</a><span class="footnote-delimiter">:</span><span class="footnote-text">type の前に @ をつけるのは、 type が予約語であるため。アクセスする場合は File.type でよい</span>
<a href="#fn-1fd0fe34" name="f-1fd0fe34" class="footnote-number">*2</a><span class="footnote-delimiter">:</span><span class="footnote-text">持てるらしい！　struct はメンバ関数をもてるので、プロパティがプライベートメンバ変数およびそのセッター・ゲッターの糖衣構文だと考えれば、別にできてもおかしくはないということかなぁ。教えて、エロいひと！</span>
<a href="#fn-2b14458a" name="f-2b14458a" class="footnote-number">*3</a><span class="footnote-delimiter">:</span><span class="footnote-text">ドキュメント読めよ</span>
<a href="#fn-82a71e39" name="f-82a71e39" class="footnote-number">*4</a><span class="footnote-delimiter">:</span><span class="footnote-text">Ruby on Rails ならやってくれただろう</span>
</div>

