<!DOCTYPE html>
<html><link rel="icon" href="https://via.placeholder.com/70x70">
<link rel="stylesheet" href="https://andybrewer.github.io/mvp/mvp.css">

<meta charset="utf-8">
<meta name="description" content="My description">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>日記：Surface Book 2 をクリーンアップした - だるろぐ - だるやなぎのブログ</title>

<style>
    nav {
        margin-bottom: 0;
    }

    body {
        font-family: "UD デジタル 教科書体 NP-R", Arial, Helvetica, sans-serif;
    }

    table {
        margin: 2em auto;
        border: none;
    }

    th, td, tr {
        text-align: right !important;
        padding: 1rem !important;
    }

    td {
        border-bottom: 1px solid gray;
    }
</style>


    
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53152247-5"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-53152247-5');
        </script>
    
<body>
        <header><nav>
    <a href="/"><img alt="Logo" src="/logo.png" height="70"></a>
    
</nav>

<h1>だるろぐ - だるやなぎのブログ</h1>

<p></p>



<hr></header>

        <main>
<article>
    <h1>日記：Surface Book 2 をクリーンアップした</h1>
    
    <p class="published">
        <time>
            公開日：
            2018/01/29
        </time>        
    </p>

    <p>週末は Surface Book 2 をクリーンアップしていた。</p>
<figure>
    <img src="/images/20180128234305.png"/> 
</figure>

<p>いうのも、この前発生していたコンテキストメニューが壊れる不具合がどうにも直らない。不要なアプリを削除したり、レジストリをいじったりすると直ったような気になるが、しばらく経つとまた壊れる。グラフィックドライバーがダメだと手の施しようがないが……ともあれ、数か月使って環境も汚れてきたことだし、ここでクリーンアップするのも悪くはないだろう。むかしは OS のクリーンインストールと環境の復旧は大変めんどくさくて、半日がかりでやっていた気がするけど、最近はデータをクラウドに保存するようになったせいか、それほど手間ではない。PowerShell と Chocolatey で作った初期化スクリプトのおかげもあり、ほぼ全自動で行える。<a href="http://blog.daruyanagi.jp/entry/2017/05/17/073339">PowerShell：環境構築を（なるべく）自動化する - だるろぐ</a>今回はインストールアプリの整理もやった</p>
<pre><code>choco install -y sizer
choco install -y dotnetcore-sdk  
choco install -y visualstudiocode 
choco install -y dropbox 
choco install -y vlc 
# choco install -y skype
choco install -y googlechrome
choco install -y unchecky
choco install -y paint.net
choco install -y firefox

# 追加
choco install -y visualstudio2017community
choco install -y steam 
choco install -y github-desktop  
```visualstudio2017community パッケージは Installer が追加されただけで、本体のインストールには失敗していた？　どうせワークロードの選択しなきゃいけないから別にいいんだけど。デスクトップ Skype は不要になったので削除した。使いことがあっても今度からは UWP 版で済ませる。残った手作業の中で面倒なのは、各種サービスのログイン処理だろうか。自分は頭の固い人間だから、パスワードロッカーのようなサービスに手を出せずじまいでいるのだけど、今回は STEAM のパスワードがどうしても思い出せなくて……そろそろ導入すべきかな、などと感じている。使いやすくて、データを流出させたり、脆弱性の修正を隠したりしないところがいいんだけど、どこかいいところはないだろうか。あと、ソフトウェアのライセンス管理が面倒くさい。うちの場合、

&lt;ul&gt;
&lt;li&gt;EmEditor&lt;/li&gt;
&lt;li&gt;WinSnap&lt;/li&gt;
&lt;/ul&gt;がそれに該当するのだけど……ストアで配布してくれたら買いなおすわ。あと、ストアアプリのインストールも面倒……OneGet で Windows Store プロバイダーが使えたりしたらいいのになぁ……。

<figure>
    <img src="/images/20180129002109.png"/> 
</figure>


応リクエストはあるみたいだけど、何も動きはないみたい。それはともかく、今回のクリーンアップで2、3、軽いトラブルにあったのでメモしておこうかと思う。

&lt;div class=&quot;section&quot;&gt;
    ### キーボードが英語配列として認識される
    Surface シリーズではもうお馴染みとなったこの不具合……もう嫌になっちゃうよね。でも、最近は GUI で治せるようになったからちょっとましかもしれない。

<figure>
    <img src="/images/20180128235909.png"/> 
</figure>


ず「設定」アプリで［言語と時刻］－［地域と言語］を開き、日本語のオプションへアクセスする。

<figure>
    <img src="/images/20180129000628.png"/> 
</figure>


で、ハードウェア キーボード レイアウトを“日本語キーボード（106/109 キー）”に変更すれば OK。以前は英語キーボードだったからこうしたトラブルとは無縁だったのだけど、自分の身に降りかかるとクソうっとうしいな。なお、反映させるには一度サインアウトしなきゃいけない。

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    ### ディスクリート GPU が認識されない
    早速 Civilization 6 で遊んでみるかと思ってゲームを起動すると、どうも遅い。調べてみると Intel の内蔵グラフィックスで動いていた。GeForce GTX 1050 が見当たらない……。これはベースからトップを外してガチャガチャしてたらいつの間にか直った。

<figure>
    <img src="/images/20180129001346.png"/> 
</figure>


起動してって言われたのでその通りにすると、外部 GPU が復活した……「タスク マネージャー」で“GPU 1”って表示されてたのが“GPU 2”になっちゃったけど、キニシナイ。

<figure>
    <img src="/images/20180129001705.png"/> 
</figure>


br/&gt;


&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    ### サウンドが死ぬ
    トラブルシューティングアシスタントに従ってドライバーを再インストールしたら直った。さほど手間ではないし、ハマるところもないと思うので割愛。

&lt;/div&gt;
&lt;div class=&quot;section&quot;&gt;
    ### ほかにやったこと
    
&lt;ul&gt;
&lt;li&gt;ディスクアクセスが遅い気がしたので、Bitlocker は無効化した&lt;/li&gt;
&lt;li&gt;要ライセンスアプリの代替品評価 → んー、やっぱり使い慣れたものがいいのでやめた&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

</code></pre>
</article>

<section>
    <style>
        article p.published { text-align: right; }

        .spacer { margin: auto 1em;}
    </style>

    <p>
        
        <a href="https://blog.daruyanagi.jp/entry/2018/01/27/080602/">&laquo; Older</a>
        
        <span class="spacer">|</span>
        <a href="/">Home</a>
        <span class="spacer">|</span>
        <a href="#">Top</a>
        <span class="spacer">|</span>
        
            <a href="https://blog.daruyanagi.jp/entry/2018/01/30/023347/">Newer &raquo;</a>
        
    </p>    
    
</section>


        </main>
        
        <footer><hr>
<p>
    <a href="/about">daruyanagi</a> &copy; 2007-2020
</p></footer>
    </body>
</html>
