
+++
date = "2012-08-21 09:29:16 +0000 UTC"
draft = false
title = "WebMatrix でファイルのアップロード（4） - アップロードしたファイルの表示"
tags = ["ASP.net Web Pages","WebMatrix"]

+++
<img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120821/20120821091848.png" alt="f:id:daruyanagi:20120821091848p:plain" title="f:id:daruyanagi:20120821091848p:plain" class="hatena-fotolife"/>そういえば、アップロードしたファイルの表示をやっていなかった<a href="#f1" name="fn1" title="アップロード「結果」の表示はやっていたけれど">*1</a>。アップロードフォルダには画像ファイルしかないはずなので、今回は img タグで決め打ちしていいかな。
```cs
# List.cshtml

@functions {
    private const string OUTPUT_DIR = "~/Files/";
}

@{
    var dir = Server.MapPath(OUTPUT_DIR);
    var files = new System.IO.DirectoryInfo(dir)
        .EnumerateFiles()
        .Select((f) => VirtualPathUtility
            .ToAbsolute(OUTPUT_DIR + f.Name));
}

&lt;!DOCTYPE html>

&lt;html lang="en">
    &lt;head>
        &lt;meta charset="utf-8" />
        &lt;title>&lt;/title>
        &lt;style>
        a {
            display: block;
            float: left;
            height: 48px; width: 48px;
            margin: 6px;
            text-align: center;
        }
        a img {
            max-height: 48px; max-width: 48px;
            border: none;
        }
        &lt;/style>
    &lt;/head>
    &lt;body>
        @foreach (var file in files)
        {
            &lt;a href="@file">&lt;img src="@file" />&lt;/a>
        }
    &lt;/body>
&lt;/html>

```結果はこんな感じ。<img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120821/20120821092040.png" alt="f:id:daruyanagi:20120821092040p:plain" title="f:id:daruyanagi:20120821092040p:plain" class="hatena-fotolife"/>びっくりするほど難しくなかった。OUTPUT_DIR はアップロード処理と共通なので、どこかにまとめておいたほうがいいな。むしろ、 OUTPUT_DIR フォルダーの内容を管理するクラスを作って、それを経由してファイルの保存・一覧をするようにするのが望ましいと思った。
<div class="footnote">
<a href="#fn1" name="f1" class="footnote-number">*1</a><span class="footnote-delimiter">:</span><span class="footnote-text">アップロード「結果」の表示はやっていたけれど</span>
</div>

