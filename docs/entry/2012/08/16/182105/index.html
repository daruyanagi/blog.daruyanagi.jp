<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <base href="http://daruyanagi.net/" />
        <link rel="canonical" href="http://daruyanagi.net/entry/2012/08/16/182105/" />

        <meta name="viewport" content="width=device-width,initial-scale=1">

        <title> 
            App_Code でサブフォルダーを利用する | だるやなぎ
        </title>

        

        
            
        

        
            <meta name="description" content="前回（WebMatrix で Markdown を少しだけ拡張してみる - だるろぐ）、 Hilight.js をこのようなフォルダー構成で配置したの、覚えてますか。
~/ App_Code/ Highlight.cshtml &amp;lt;-- ぇ？ Highlight/ Lisence Files Content/ /Highlight Theme Skins Scripts/ Highlight/ hilight.pack.js ```パッとみて「これイケてなくね」って思いません？ Highlight.cshtml は ~/App_Code/Highlight 以下の配置される方がキレイですよね。 ~/ App_Code/ Highlight/ Highlight.cshtml &lt;&ndash; こうだろ！ Lisence Files Content/ Highlight/ Theme Skins Scripts/ Highlight/ hilight.pack.js
```xml &lt;!--?--&gt;xml version=&quot;1.0&quot;?&gt; &lt;configuration&gt;&lt;/configuration&gt; .web&gt; debug=&quot;false&quot;&gt; &lt;codesubdirectories&gt;&lt;/codesubdirectories&gt; directoryName=&quot;Highlight&quot;/&gt; .web&gt; ```~/App_Code/ フォルダーではソースコードの言語を自動判別してくれるのだけれど、サブフォルダーに分ければ異なる言語を混ぜて利用する、なんてこともできるらしい。へぇ、知らなかった。 &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/t990ks23.aspx&quot;&gt;Shared Code Folders in ASP.NET Web Site Projects | Microsoft Docs&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;  でも、この方法でサブフォルダーをコンパイル対象に含めても cshtml ファイルの面倒まではみてくれないみたい……。しょうがないので、静的クラスに書き換えてしまおう。 ```cs # Highlight." />
        

        
        
        <link rel="stylesheet" href="css/style.css">

    </head>
    <body class="body">

        <header class="global-header">
            <h1><a href="/" >だるやなぎ</a></h1>

<p>そうだ、だるだるしよう。</p>


        </header>

        <main>
            
    <article class="entry">

        <div class="entry__header">
            <div class="entry__header-taxonomies">
                
                
                    <div class="entry__header-taxonomies-category">
                        <span class="entry__header-taxonomies-category-title">
                            <a class="entry__header-taxonomies-category-title-link" href="http://daruyanagi.net/entry/">
                                Entries
                            </a>
                        </span>
                    </div>
                
                
                    <div class="entry__header-taxonomies-tags">
                        <ul class="entry__header-taxonomies-tags-list" >
                            
                                
                                
                                    <li class="entry__header-taxonomies-tags-list-item">
                                        <a class="entry__header-taxonomies-tags-list-itelink" href="http://daruyanagi.net/tags/asp.net-web-pages/">ASP.net Web Pages</a>
                                    </li>
                                
                            
                        </ul>
                    </div>
                
            </div>

            <div class="entry__header-title">
                <a class="entry__header-title-link" href="http://daruyanagi.net/entry/2012/08/16/182105/" >
                    <h1 class="entry__header-title-link-text">App_Code でサブフォルダーを利用する</h1>
                </a>
            </div>

            <div class="entry__header-date">
                <P>公開日：<time>2012/08/16</time>
                </P>
            </div>

        </div>
        <div class="entry__content">
            <p><figure>
    <img src="/images/20120816181253.png"/> 
</figure>
前回（<a href="https://blog.daruyanagi.jp/entry/2012/08/16/155714">WebMatrix で Markdown を少しだけ拡張してみる - だるろぐ</a>）、 Hilight.js をこのようなフォルダー構成で配置したの、覚えてますか。</p>
<pre><code>~/
    App_Code/
        Highlight.cshtml &amp;lt;-- ぇ？
        Highlight/
            Lisence Files
    Content/
        /Highlight
            Theme Skins
    Scripts/
        Highlight/
            hilight.pack.js
```パッとみて「これイケてなくね」って思いません？ Highlight.cshtml は ~/App_Code/Highlight 以下の配置される方がキレイですよね。
</code></pre><p>~/
App_Code/
Highlight/
Highlight.cshtml &lt;&ndash; こうだろ！
Lisence Files
Content/
Highlight/
Theme Skins
Scripts/
Highlight/
hilight.pack.js</p>
<pre><code class="language-~/App_Code/" data-lang="~/App_Code/">```xml
&lt;!--?--&gt;xml version=&quot;1.0&quot;?&gt;
&lt;configuration&gt;&lt;/configuration&gt;
    .web&gt;
      debug=&quot;false&quot;&gt;
         &lt;codesubdirectories&gt;&lt;/codesubdirectories&gt;
           directoryName=&quot;Highlight&quot;/&gt;
         
      
   .web&gt;


```~/App_Code/ フォルダーではソースコードの言語を自動判別してくれるのだけれど、サブフォルダーに分ければ異なる言語を混ぜて利用する、なんてこともできるらしい。へぇ、知らなかった。

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/t990ks23.aspx&quot;&gt;Shared Code Folders in ASP.NET Web Site Projects | Microsoft Docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;<figure>
    <img src="/images/20120816181753.png"/> 
</figure>
でも、この方法でサブフォルダーをコンパイル対象に含めても cshtml ファイルの面倒まではみてくれないみたい……。しょうがないので、静的クラスに書き換えてしまおう。
```cs
# Highlight.cshtml

@helper Include(string theme = &quot;default&quot;){
    &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;~/Content/Highlight/@(theme).css&quot;&gt;
    &amp;lt;script src=&quot;~/Scripts/Highlight/highlight.pack.js&quot;&gt;&amp;lt;/script&gt;
    &amp;lt;script&gt;hljs.initHighlightingOnLoad();&amp;lt;/script&gt;
}

```書き換え前。
```cs
using System.Web;

public static class Highlight
{
    const string STYLE_DIR = &quot;~/Content/Highlight/&quot;;
    const string SCRIPT_DIR = &quot;~/Scripts/Highlight/&quot;;
    const string HTML = @&quot;&lt;!-- for Highlight.js support --&gt;
        &lt;link rel=&quot;&quot; stylesheet&quot;&quot;=&quot;&quot; href=&quot;&quot; {0}{1}.css&quot;&quot;=&quot;&quot;/&gt;
        &lt;script src=&quot;&quot; {2}highlight.pack.js&quot;&quot;=&quot;&quot;&gt;&lt;/script&gt;
        &lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;&quot;;

    public static HtmlString Include(string theme = &quot;default&quot;)
    {
        return new HtmlString(
            string.Format(
                HTML, 
                VirtualPathUtility.ToAbsolute(STYLE_DIR),
                theme,
                VirtualPathUtility.ToAbsolute(SCRIPT_DIR)
            )
        );
    }
}

```書き換え後。ちょっと長くなったけれど、これはそれだけ「ヘルパーがすげえ！」ということにしておいてください。これでブツがそろったので、今度は NuGet パッケージにして公開しましょうかね（予定）。


</code></pre>
        </div>
        <div class="entry__footer">
            
            <div class="entry__footer-navigation">
                <span class="entry__footer-prev">
                     <a class="entry__page-navigation-link" href="http://daruyanagi.net/entry/2012/08/17/034631/">&laquo; 前の記事</a> 
                </span>
                <span class="entry__footer-lastmod">
                    
                    最終更新日：<time
                        datetime="2012-08-16T18:21:05JST">2012/08/16</time>
                    
                </span>
                <span class="entry__footer-next">
                     <a class="entry__page-navigation-link" href="http://daruyanagi.net/entry/2012/08/16/162322/">次の記事 &raquo; </a> 
                </span>
            </div>
        </div>

    </article>

        </main>

        <footer class="global-footer">
            <p>&copy; 2020 daruyanagi.</p>

        </footer>
    </body>
</html>