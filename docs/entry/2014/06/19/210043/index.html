<!DOCTYPE html>
<html><link rel="icon" href="https://via.placeholder.com/70x70">
<link rel="stylesheet" href="https://andybrewer.github.io/mvp/mvp.css">

<meta charset="utf-8">
<meta name="description" content="My description">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>オープン拡張辞書を Windows Runtime アプリで読み書きする（1） - だるろぐ - だるやなぎのブログ</title>

<style>
    nav {
        margin-bottom: 0;
    }

    body {
        font-family: "UD デジタル 教科書体 NP-R", Arial, Helvetica, sans-serif;
    }

    table {
        margin: 2em auto;
        border: none;
    }

    th, td, tr {
        text-align: right !important;
        padding: 1rem !important;
    }

    td {
        border-bottom: 1px solid gray;
    }
</style>


    
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53152247-5"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-53152247-5');
        </script>
    
<body>
        <header><nav>
    <a href="/"><img alt="Logo" src="/logo.png" height="70"></a>
    
</nav>

<h1>だるろぐ - だるやなぎのブログ</h1>

<p></p>



<hr></header>

        <main>
<article>
    <h1>オープン拡張辞書を Windows Runtime アプリで読み書きする（1）</h1>
    
    <p class="published">
        <time>
            公開日：
            2014/06/19
        </time>        
    </p>

    <blockquote>
</blockquote>
<pre><code>    オープン拡張辞書は、Microsoft IMEの追加辞書を作成、共有する機能です。簡単にインストールができるので、Webページや共有フォルダーに置いたり、メールに添付して配布したり、シーンに応じて多様な方法で共有と配布ができます。

    Microsoft IME オープン拡張辞書について
</code></pre>
<p>Windows 8 以降だと OS 標準の IME で使えるのに、割りと流行ってない感じ。もっと使われないともったいなーと思ったので、こいつが編集できる Windows ストア アプリでも作ろうと思い立った。オープン拡張辞書には二種類ある。</p>
<ul>
<li>.dctx：　UTF-8 でエンコードされた XML ファイル</li>
<li>.dctxc：　.dctx を ZIP で圧縮したもの</li>
</ul>あと署名を付けると収録できる単語数が増えるとか（署名されていない場合は1万語まで）いろいろあるのだけど、これはまぁ、今のところどうでもいい。今回はとりあえず .dctx が読めることを目標にする。ZIP うんぬんは、まぁ、.NET Framework 4.5 でごにょごにょすれば割と簡単にできるのだろう（慢心とりあえずはクラス作りから。
```cs
public class OpenExtendedDictionary
{
    public OpenExtendedDictionary()
    {
        DictionaryInfo = new OpenExtendedDictionaryInfo();
    }
<pre><code>public string DictionaryGuid { get; set; }
public string DictionaryLanguage { get; set; }
public string DictionaryVersion { get; set; }
public bool CommentInsertion { get; set; }
public OpenExtendedDictionaryInfo DictionaryInfo { get; set; }
public ObservableCollection&amp;lt;OpenExtendedDictionaryEntry&gt; DictionaryEntries { get; set; }
</code></pre>
<p>}</p>
<p>public class OpenExtendedDictionaryInfo
{
public string ShortName { get; set; }
public string LongName { get; set; }
public string Description { get; set; }
public string Copyright { get; set; }
public string Language { get; set; }
}</p>
<p>public class OpenExtendedDictionaryEntry
{
public string PartOfSpeech { get; set; }
public string OutputString { get; set; }
public string InputString { get; set; }
public int Priority { get; set; }
public bool ReverseConversion { get; set; }
public bool CommonWord { get; set; }
}</p>
<pre><code class="language-こんな感じだろうか。ほんとは" data-lang="こんな感じだろうか。ほんとは">
&lt;div class=&quot;section&quot;&gt;
    ### 次回
    XML を読み書きする方法は3つほどある。

&lt;ol&gt;
&lt;li&gt;XmlDocument を使う。あまり使ったことがないから知らん&lt;/li&gt;
&lt;li&gt;XDocument を使う。LINQ と相性がいい&lt;/li&gt;
&lt;li&gt;シリアライズする。どうやるのかわからんが、一番かっこよさそうな実装&lt;/li&gt;
&lt;/ol&gt;気が向いたら続きを書く。

&lt;/div&gt;

</code></pre>
</article>

<section>
    <style>
        article p.published { text-align: right; }

        .spacer { margin: auto 1em;}
    </style>

    <p>
        
        <a href="https://blog.daruyanagi.jp/entry/2014/06/17/022857/">&laquo; Older</a>
        
        <span class="spacer">|</span>
        <a href="/">Home</a>
        <span class="spacer">|</span>
        <a href="#">Top</a>
        <span class="spacer">|</span>
        
            <a href="https://blog.daruyanagi.jp/entry/2014/06/19/235241/">Newer &raquo;</a>
        
    </p>    
    
</section>


        </main>
        
        <footer><hr>
<p>
    <a href="/about">daruyanagi</a> &copy; 2007-2020
</p>

<script data-ad-client="ca-pub-0944887782985208" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></footer>
    </body>
</html>
