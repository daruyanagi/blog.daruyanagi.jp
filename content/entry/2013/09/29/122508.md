
+++
date = "2013-09-29 12:25:08 +0000 UTC"
draft = false
title = "WebMatrix 3"
tags = ["WebMatrix","ASP.net Web Pages","ASP.net"]

+++
ちょいとログを外部ファイルに吐きたくなって、テキトーにこんなコードを書いてみた。{{< figure src="/images/20130929121802.png"  >}}
```cs
#App_Code/Logger.cshtml

@helper Write(string message)
{
    System.IO.File.AppendAllText(
        Server.MapPath("~/log.txt"),
        string.Format("{0}:\t{1}\r\n", DateTime.Now, message)
    );
}

```これを Default.cshtml でテストしてみた。{{< figure src="/images/20130929122015.png"  >}}
```html
@{
     Logger.Write("冒頭のコードブロック内で記述");
}



&lt;html lang="ja">
    &lt;head>
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        &lt;meta charset="utf-8" />
        &lt;title>マイ サイトのタイトル&lt;/title>
        &lt;link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    &lt;/head>
    &lt;body>
        @Logger.Write("Body 内で記述")
    &lt;/body>
&lt;/html>

```結果はというと――{{< figure src="/images/20130929122031.png"  >}}――冒頭のコードブロック内で記述したログは記録されない。「あれ、なんでだろう？」と思って、あちこちごちゃごちゃ弄ってみたのだけど、正解はコレだった。
```html
@{
     @Logger.Write("冒頭のコードブロック内で記述");
}

```{{< figure src="/images/20130929122557.png"  >}}Logger.Write() のまえに @ を足せば実行される。
```html
@{
     @(
         Logger.Write("冒頭のコードブロック内で記述")
     )
}

```でもいいのだけど。しっかし、これ、なぜなんだろう。自分はまだまだ Razor がわかってないな。


