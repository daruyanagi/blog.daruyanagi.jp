<!DOCTYPE html>
<html><link rel="icon" href="https://via.placeholder.com/70x70">
<link rel="stylesheet" href="https://andybrewer.github.io/mvp/mvp.css">

<meta charset="utf-8">
<meta name="description" content="My description">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Windows ストアアプリでデータベース（SQLite 3）を使う - だるろぐ - だるやなぎのブログ</title>

<style>
    nav {
        margin-bottom: 0;
    }

    body {
        font-family: "UD デジタル 教科書体 NP-R", Arial, Helvetica, sans-serif;
    }

    table {
        margin: 2em auto;
        border: none;
    }

    th, td, tr {
        text-align: right !important;
        padding: 1rem !important;
    }

    td {
        border-bottom: 1px solid gray;
    }
</style>


    
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53152247-5"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-53152247-5');
        </script>
    
<body>
        <header><nav>
    <a href="/"><img alt="Logo" src="/logo.png" height="70"></a>
    
</nav>

<h1>だるろぐ - だるやなぎのブログ</h1>

<p></p>



<hr></header>

        <main>
<article>
    <h1>Windows ストアアプリでデータベース（SQLite 3）を使う</h1>
    
    <p class="published">
        <time>
            公開日：
            2012/09/24
        </time>        
    </p>

    <p><img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120924/20120924010032.gif" alt="f:id:daruyanagi:20120924010032g:plain" title="f:id:daruyanagi:20120924010032g:plain" class="hatena-fotolife"/>UPDATED HOWTO: SQLite with Windows 8 apps<br/>
<a href="http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx"><a href="http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx">http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx</a></a>@kaorun さんのはてブ経由で知った。前試したときはうまくいかなかったのだけど、今回はうまくできたっぽい。ポータブルなデータベースはやっぱりほしいよねぇ……。</p>
<div class="section">
    ### 拡張機能「SQLite for Windows Runtime」をインストール
    <img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120924/20120924003514.png" alt="f:id:daruyanagi:20120924003514p:plain" title="f:id:daruyanagi:20120924003514p:plain" class="hatena-fotolife"/>グローバルにインストールされるので、最初に一度やればよい。
</div>
<div class="section">
    ### NuGet パッケージ「sqlite-net」をインストール
    <img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120924/20120924003710.png" alt="f:id:daruyanagi:20120924003710p:plain" title="f:id:daruyanagi:20120924003710p:plain" class="hatena-fotolife"/>これはプロジェクトごとにインストール。マネージドで扱うためのラッパーのようで、C# のソースコードで提供されている。Visual Basic で使いたい場合は一工夫必要みたい。
</div>
<div class="section">
    ### 参照の追加
    <img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120924/20120924004222.png" alt="f:id:daruyanagi:20120924004222p:plain" title="f:id:daruyanagi:20120924004222p:plain" class="hatena-fotolife"/>「Microsoft Visual C++ Runtime Pakage」と「SQLite for Windows Runtime」を参照に追加。
</div>
<div class="section">
    ### ビルドターゲットを変更
    <img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120924/20120924004424.png" alt="f:id:daruyanagi:20120924004424p:plain" title="f:id:daruyanagi:20120924004424p:plain" class="hatena-fotolife"/>Any CPU では動かないので、ほかの適当なものに変えておく。まぁ、とりあえず x86 とかでいいんじゃないかな。
</div>
<div class="section">
    ### 動かしてみる。
    空のテンプレートで、サンプルコードを試してみる。
```cs
namespace App1
{
    sealed partial class App : Application
    {
        public App()
        {
            this.InitializeComponent();
            this.Suspending += OnSuspending;
<pre><code>        LoadData();
    }

    ：
    ：

    public void LoadData()
    {
        var dbPath = Path.Combine(
            ApplicationData.Current.LocalFolder.Path,
            &quot;db.sqlite&quot;);

        using (var db = new SQLite.SQLiteConnection(dbPath))
        {
            db.CreateTable&amp;lt;Person&gt;();

            db.RunInTransaction(() =&gt;
            {
                db.Insert(new Person() {
                    FirstName = &quot;Tim&quot;, LastName = &quot;Heuer&quot;
                });
            });
        }
    }
}
</code></pre>
<p>}</p>
<p>public class Person
{
[SQLite.AutoIncrement, SQLite.PrimaryKey]
public int ID { get; set; }
public string FirstName { get; set; }
public string LastName { get; set; }
}</p>
<pre><code class="language-<img" data-lang="<img">
&lt;/div&gt;

</code></pre>
</article>

<section>
    <style>
        article p.published { text-align: right; }

        .spacer { margin: auto 1em;}
    </style>

    <p>
        
        <a href="https://blog.daruyanagi.jp/entry/2012/09/23/234241/">&laquo; Older</a>
        
        <span class="spacer">|</span>
        <a href="/">Home</a>
        <span class="spacer">|</span>
        <a href="#">Top</a>
        <span class="spacer">|</span>
        
            <a href="https://blog.daruyanagi.jp/entry/2012/09/24/210732/">Newer &raquo;</a>
        
    </p>    
    
</section>


        </main>
        
        <footer><hr>
<p>
    <a href="/about">daruyanagi</a> &copy; 2007-2020
</p></footer>
    </body>
</html>
