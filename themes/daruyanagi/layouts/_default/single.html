{{ define "main" }}
<article class="container" style="margin-top: 3rem;">
    <h1>{{.Title}}</h1>
    
    <p class="published text-right">
        公開日：<time>
            {{ .Date.Format "2006/01/02"}}
        </time>        
    </p>

    {{ .Content }}

    <footer>

        <!-- Hatena bookmark comment -->
        <style>
            .hatena-bookmark header {
            }

            .hatena-bookmark dt {
            }

            .hatena-bookmark dd {
            }

            .hatena-bookmark time {
                color: #999;
            }
        </style>

        <script type="text/javascript">
        function HatenaBookmarkCallback(data)
        {
            if (data === null)
            {
                document.write(`
                <section class='card hatena-bookmark'>
                    <header class="card-header hatena-bookmark-header">はてなブックマークのコメント：<a href='https://b.hatena.ne.jp/entry/{{ .Permalink | safeURL }}'>0 user</a></header>
                    <p class='card-body'>この記事にはまだコメントがついていません。
                    <a class='btn btn-primary float-right' href='https://b.hatena.ne.jp/my/add.confirm?url={{ .Permalink | safeURL }}'>コメントを残す</a>
                    </p>
                </section>`);
                return;
            }

            let comments = "";

            for (const bookmark of data.bookmarks) {
                comments += `
                    <li class='list-group-item hatena-bookmark-item'>
                        <img class='hatena-bookmark-item-image' src='http://cdn1.www.st-hatena.com/users/${ bookmark.user.substring(0, 2) }/${ bookmark.user }/profile_s.gif'>
                        <span class='hatena-bookmark-item-user'><a href='https://b.hatena.ne.jp/{ bookmark.user }/'>${ bookmark.user }</a></span>
                        <span class='hatena-bookmark-item-comment'>${ bookmark.comment }</span>
                        <time class='hatena-bookmark-item-timestamp'>${ bookmark.timestamp }</time>
                    </li>
                `;
            }

            const html = `
            <section class='card hatena-bookmark'>
                <header class="card-header hatena-bookmark-header">はてなブックマークのコメント：<a href='https://b.hatena.ne.jp/entry/{{ .Permalink | safeURL }}'>${ data.count } user${ data.count === 0 ? '' : 's' }</a></header>
                <ui class='list-group list-group-flush hatena-bookmark-comments-list'>
                ${ comments }
                </ul>
                <footer class='card-body'><a class='btn btn-primary float-right' href='https://b.hatena.ne.jp/my/add.confirm?url={{ .Permalink | safeURL }}'>コメントを残す</a></footer>
            </section>`;

            document.write(html);            
        }
        </script>
        
        <script type="text/javascript"
            src="//b.hatena.ne.jp/entry/jsonlite/?url={{ .Permalink | safeURL }}&callback=HatenaBookmarkCallback">
        </script>
        
        <p class="text-right">
            <a href="{{ .Site.Params.GitHub }}tree/master/content{{ .RelPermalink }}"><img src="https://github.com/favicon.ico" style="height: 16px; vertical-align: middle;"> View on GitHub.com</a>
            / 
            最終更新日：<time>{{ .Lastmod.Format "2006/01/02"  }}</time> 
        </p>
    </footer>
</article>

<section class="container text-center"> 

    <p>
        {{ with .PrevInSection }}
        <a href="{{ .Permalink }}">&laquo; Older</a>
        {{ end }}
        <span > - </span>
            <a href="/">🏠 Home</a>
        <span > - </span>
        {{ with .NextInSection }}
            <a href="{{ .Permalink }}">Newer &raquo;</a>
        {{ end }}
    </p>    
    
</section>

{{end}}