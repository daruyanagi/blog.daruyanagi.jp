
+++
date = "2012-11-16 04:28:40 +0000 UTC"
draft = false
title = "WebMatrix で数式を表現する（１）"
tags = ["ASP.net Web Pages","WebMatrix"]

+++
<img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20121116/20121116034508.png" alt="f:id:daruyanagi:20121116034508p:plain" title="f:id:daruyanagi:20121116034508p:plain" class="hatena-fotolife"/>まず考えられる方法は <a href="https://developers.google.com/chart/?hl=ja">Google Chart Tools — Google Developers</a> を利用することです。TeX の数式を画像ファイルに変換してくれます。

<ul>
<li><a href="https://developers.google.com/chart/infographics/docs/formulas">Mathematical Formulas - Infographics (Deprecated) — Google Developers</a></li>
</ul>Deprecated（非推奨）になっているのが気になりますけれど、まぁ、使えなくなるまで使えばいいんじゃないでしょうか。TeX による数式表現は業界標準（？）でもあるんで、万が一使えなくなってもいろいろ対処法はあるかと。あと、はてな記法でも使えるので覚えておくと使うことがあるかもしれない。必要なパラメーターは、

<ul>
<li>cht=tx</li>
<li>chl=DATA</li>
</ul>で、DATA は TeX による数式表現を URL エンコードしたものになります。たとえばこんな感じ。<img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20121116/20121116035411.png" alt="f:id:daruyanagi:20121116035411p:plain" title="f:id:daruyanagi:20121116035411p:plain" class="hatena-fotolife"/>
```html
# Default.cshtml

@{
    
}



&lt;html lang="ja">
    &lt;head>
        &lt;meta charset="utf-8" />
        &lt;title>マイ サイトのタイトル&lt;/title>
        &lt;link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    &lt;/head>
    &lt;body>
        &lt;img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=@UrlEncode(@"\bar{H}_{n+2}(x) = \sqrt{\frac{2}{n+2}} x \bar{H}_{n+1}(x) \sqrt{\frac{n+1}{n+2}} \bar{H}_n(x)");" />
    &lt;/body>
&lt;/html>

```まぁ、 \bar{H}_{n+2}(x) = \sqrt{\frac{2}{n+2}} x \bar{H}_{n+1}(x) \sqrt{\frac{n+1}{n+2}} \bar{H}_n(x) なんてスラスラ書くのは無理だけど、自分の場合、

<ul>
<li>\hoge：文字 hoge の埋め込み（\alpha で α）</li>
<li>\hoge{}：引数をとって hoge る（\sqrt{0} なら √ {0}、\frac{0}{1} なら分数 {0} / {1} ）</li>
<li>^{Hoge}：上付き文字（指数とか）</li>
<li>_{hoge}：下付き文字（添え字とか）</li>
</ul>の4つだけ覚えている。あとはググる。

<div class="section">
    ### ヘルパー化
    さて、毎回イメージタグを書くのは不毛なので、これをヘルパー化することを考えましょう。たとえばこんな感じ。
```html
#App_Code\GoogleChart.cshtml

@helper Formula(string tex_expression){
    const string API = "http://chart.apis.google.com/chart?cht={0}&amp;chl={1}";
    var cht = "tx";
    var chl = HttpUtility.UrlEncode(tex_expression);
    &lt;img src="@string.Format(API, cht, chl)" />
}

```使い方はこんな感じ。
```html
# Default.cshtml

@{
    
}



&lt;html lang="ja">
    &lt;head>
        &lt;meta charset="utf-8" />
        &lt;title>マイ サイトのタイトル&lt;/title>
        &lt;link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    &lt;/head>
    &lt;body>
        @GoogleChart.Formula(@"\bar{H}_{n+2}(x) = \sqrt{\frac{2}{n+2}} x \bar{H}_{n+1}(x) \sqrt{\frac{n+1}{n+2}} \bar{H}_n(x)")
    &lt;/body>
&lt;/html>

```
</div>
<div class="section">
    ### 注意
    リクエストのリミットはとくに決まっていないようですが、250,000/日 を超える場合は chart-api-notifications@google.com に連絡しなければいけないそうです。

</div>

