
+++
date = "2012-12-27 07:02:46 +0000 UTC"
draft = false
title = "WebMatrix 2：ASP.NET と PHP（2）"
tags = ["C#","ASP.net","ASP.net Web Pages","WebMatrix","PHP"]

+++
<a href="https://blog.daruyanagi.jp/entry/2012/12/11/085125">WebMatrix 2：ASP.NET と PHP - だるろぐ</a> あたりを書いた時に Twitter で「WebMatrix 2（というより、Razor 記法）は Visual Basic に対応していないのか？」という疑問を見かけたのですが、ちゃんと対応しています。たとえば前回の例の場合、こんなふうに書きます。
```vb
@Code
    Dim s = "Hello! World" &#39; 追加
End Code

&lt;!DOCTYPE html>

&lt;html lang="en">
    &lt;head>
        &lt;meta charset="utf-8" />
        &lt;title>&lt;/title>
    &lt;/head>
    &lt;body>
        @s &lt;!-- 追加 -->
    &lt;/body>
&lt;/html>

```C# の @{ … } が @Code … End Code に置き換わったぐらいかな。For 文の書き方なんかも VB 風に書けます。詳しいことは <a href="http://www.atmarkit.co.jp/fdotnet/rapidmaster/rapidmaster_04/rapidmaster_04.html">VB Razor構文 基礎文法 総まとめ - ＠IT</a> でも参照してください。個人的にはこれから始める人が VB で Razor を書く意味はあまりないのではないかなと思います。XML の処理などは簡単なんだそうですけど。あと、前回は言わなかったけれど &lt;% … %> という ASP.NET の古い記法（ASPX、C# または Visual Basic）を利用することもできます。 まぁ、それはともかく。

{{< figure src="/images/20121227064529.png"  >}}

んなにいっぱいあるんだったら、どれが一番いいのかって気になりますよね。前にも言った通り、ぶっちゃけ好きなものを選べばいいと思うんですけど（Razor/C# を推しますけどね）、今回は簡単なプログラム（0から10,000までの2乗をリスト表記）で速さを計測してみました。

<div class="section">
    ### PHP
    

{{< figure src="/images/20121227064356.png"  >}}

HP はあんまり知らないのでこれでいいのか多少不安ですけど。

<ul>
<li>0.007682秒</li>
<li>0.004367秒</li>
<li>0.003787秒</li>
<li>0.003856秒</li>
<li>0.003891秒</li>
</ul>最初だけ時間を食いましたが、こんな感じ。以下、初回計測時にはサーバーを一度再起動させています。PHP の結果を見ると、初回起動時はちょっと時間がかかるのかなと感じたので。念のためもう一度計測したら、サーバー再起動後で 0.0035609999999999秒 でした。0.007秒というのは、異常値として処理しちゃってもいいレベルかな。

</div>
<div class="section">
    ### •ASP.NET (ASPX/C#)
    

{{< figure src="/images/20121227064720.png"  >}}

br/>


<ul>
<li>0.0029692秒</li>
<li>0.0025189秒</li>
<li>0.0024252秒</li>
<li>0.0024489秒</li>
<li>0.0024761秒</li>
</ul>安定して速かったです。ただ、これで書こうかという気は起こらないのですけど。

</div>
<div class="section">
    ### •ASP.NET (Razor/C#)
    

{{< figure src="/images/20121227065042.png"  >}}

br/>


<ul>
<li>0.0028398秒</li>
<li>0.0024506秒</li>
<li>0.0024667秒</li>
<li>0.0025609秒</li>
<li>0.0026207秒</li>
</ul>ASPX よりはわずかながら遅いような（ほとんど誤差レベルですが）。PHP よりは速かった。

</div>
<div class="section">
    ### •ASP.NET (Razor/Visual Basic)
    

{{< figure src="/images/20121227065439.png"  >}}

br/>


<ul>
<li>0.0046345秒</li>
<li>0.0039607秒</li>
<li>0.0036215秒</li>
<li>0.0036577秒</li>
<li>0.0038143秒</li>
</ul>ついでに Razor だけ VB でも試してみました。PHP よりはマシという感じの速さですね。まぁ、簡単すぎてあんまり参考にならないレベルですけどちょっと興味がわいたので試してみました。著しく不公平なところがあれば、ぜひ教えてください。正直あんまり自信ない。

</div>

