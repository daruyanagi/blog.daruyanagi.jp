
+++
date = "2017-08-26 20:29:31 +0000 UTC"
draft = false
title = "Surface Laptop ＋デュアルディスプレイ環境のための AHK スクリプトを書いた"
tags = ["AutoHotkey","Surface Laptop"]

+++
{{< figure src="/images/20170821161957.jpg"  >}}今日は重い腰を上げて、たまっていたタスクをいっぺんに片づけた。

<ul>
<li>メインのデスクトップ PC に貰い物のグラボを刺した（5月にもらったのに、そのまんま放置！　電源が足りててよかったー）</li>
<li>Surface 3 を Windows 10 S（Insider Preview）にした（これはまた後日書くと思う）</li>
<li>Surface Laptop を Windows 10 Pro にして、いろいろお仕事ができる環境にした</li>
<li>週末までに Amazon で買いあさった便利グッズで部屋を整理した</li>
</ul>ついでに、Surface Laptop ＋デュアルディスプレイ環境をより使いやすくするための AutoHotKey スクリプトをしこしこ書いてた。慣れないからやたら時間かかったけど、だいぶ使い勝手が上がった気がする。

<div class="section">
    ### マルチモニター環境でウィンドウを移動する
    Windows 10 では［Windows］＋［Shift］＋［→］キーや［Windows］＋［Shift］＋［←］キーで**“アクティブウィンドウを隣のモニターへ移動”**できるのだけど、このショートカットを押すのがめんどくさい。Surface Laptop のキーボードには、右［Windows］キーがないので、どうしても両手を使う必要がある。{{< figure src="/images/20170826202400.png"  >}}というわけで、右側の［Shift］キーをと矢印キー（**要するにキーボードの右下らへん**）だけで移動できるようにした。
```
>+Right::Send,{RWin Down}{RShift Down}{Right}{RShift Up}{RWin Up}
```［Windows］＋［Shift］＋［→］キーは<code>#+Right</code>と書けると思ったのだけど、それではうまくいかないみたいで、解決策を探すのにだいぶ時間を食ってしまった。でも、おかげでアクティブウィンドウを片手でほいほいモニター移動できるようになった。要らないウィンドウはポイだ！

</div>
<div class="section">
    ### ドックに接続せずに使うときは仮想デスクトップをバリバリ使う
    さて、ドックから外したときは画面が一つになってしまうので、代わりに仮想デスクトップをバリバリ使いたいよね。でも、仮想デスクトップ関連のホットキーも［Windows］キーを使うので、同じような問題に直面してしまう。というわけで、これも右手だけで行えるようにしてみた。
```
; Virtual desktop (Left Move)
>!Left::Send,#^{Left}
AppsKey &amp; Left::Send,#^{Left}

; Virtual desktop (Right Move)
>!Right::Send,#^{Right}
AppsKey &amp; Right::Send,#^{Right}

; Virtual desktop (Create)
>!Up::Send,#^d
AppsKey &amp; Up::Send,#^d

; Virtual desktop (Delete)
AppsKey &amp; Down::Send,#^{F4}
>!Down::Send,#^{F4}
```右［Alt］キーと

<ul>
<li>［→］キーで次の仮想デスクトップへ切り替え</li>
<li>［←］キーで前の仮想デスクトップへ切り替え</li>
<li>［↑］キーで仮想デスクトップの作成</li>
<li>［↓］キーで仮想デスクトップの削除</li>
</ul>に割り当ててみた（右［Alt］キーの代わりに［Apps］キーも使える。どっちにするか迷ったので、両方とも使えるようにした）。実は MacBook（BootCamp）は三本指ジェスチャーが使えないので、日頃から似たような AHK スクリプトを書いて使っている。[Macbook でサクッと Task View が呼べたらいいのになぁ、という話。 - だるろぐ](http://blog.daruyanagi.jp/entry/2016/10/05/213634)それに操作感が似ているので、個人的には割と使いやすい（慣れちゃったんだよね）。タッチパッドを三本指だの四本指だのでスワイプするよりも楽だと思うし（たまにミスるし、Surface Laptop のタッチパッドは Mac に比べると少し狭い）。{{< figure src="/images/20170826200522.png"  >}}あと、仮想デスクトップを使うならおすすめの「**SylphyHorn**」も入れた。仮想デスクトップの番号を出したり、アクティブウィンドウを隣の仮想デスクトップへホットキーで飛ばしたり、仮想デスクトップの切り替えをローテーション（最後だったら最初に戻す）してくれる。[ホットキー一発で作業中のウィンドウを別の仮想デスクトップへ移動させる「SylphyHorn」NOT SUPPORTED](http://forest.watch.impress.co.jp/docs/review/755254.html)ストアで配布されてるのも素晴らしい……。[SylphyHorn を購入 - Microsoft ストア 日本](https://www.microsoft.com/ja-jp/store/p/sylphyhorn/9nblggh58t01)さっき書いた**「ほかのモニターへアクティブウィンドウを移動させる」**機能は、ドックにつないでいないときは無駄なので、代わりに「SylphyHorn」の機能で隣の仮想デスクトップへ飛ばしてみるようにしてみた。
```
IsMultimonitor()
{
   sysget, cnt, MonitorCount
   return cnt > 1
}

; Move to next monitor (とりあえず右の場合だけ)
>+Right::
    if IsMultimonitor()
    {
        Send,{RWin Down}{RShift Down}{Right}{RShift Up}{RWin Up}
    }
    else
    {
        Send,{LWin Down}{LCtrl Down}{LAlt Down}{Right}{LAlt Up}{LCtrl Up}{LWin Up}
    }
return
```コンテキストによって挙動が違うのはあまりよくないかもしれないけど、自分の中では**「邪魔なウィンドウをほかのモニター or デスクトップに飛ばす」**という点では大して変わりがないので、あんまり混乱はないかも。せっかく書いたスクリプトなので、なくさないように GitHub で管理。バイナリもあるので、もしほしい人がいたら使ってください（ほかの人にとって使い勝手のいいものかどうかは知らんが……）。
<div class="github-card" data-user="daruyanagi" data-repo="DesktopHelper" data-width="400" data-height="" data-theme="default"></div>
<script src="https://cdn.jsdelivr.net/github-cards/latest/widget.js"></script>


</div>

