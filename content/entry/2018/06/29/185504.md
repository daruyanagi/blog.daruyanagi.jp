
+++
date = "2018-06-29 18:55:04 +0000 UTC"
draft = false
title = "6月23日：貝殻本で PowerShell のお勉強をした"
tags = ["読書","PowerShell"]

+++
第1章だけ読んで、ちょっと手を動かしてみた。[6月5日：『PowerShell実践ガイドブック』 - だるろぐ](https://blog.daruyanagi.jp/entry/2018/06/05/030249)今回の目標は PowerShell ISE から Visual Studio Code への移行がメイン。Visual Studio Code は知らないでもないし、使いやすいのは知ってるし、PowerShell ISE はそのうちディスコンになるだろうし、早晩移行はしなければならないのだけど、おっさんになるとほんとダメだね……なんとなくクセで ISE を起動してしまう。めんどくさいけれどちゃんと環境を作って、Visual Studio Code を使う癖を付けなければならない。

{{< figure src="/images/20180629182933.png"  >}}

では丁寧に拡張機能の導入方法が書いてあるけど、Visual Studio Code は結構賢いので、PS1 ファイルを開くと「推奨する拡張機能」を教えてくれる。案内に従ってインストールして、リロードするだけで PowerShell 環境が完成するのでらくちんだね。

{{< figure src="/images/20180629183159.png"  >}}

なみに PowerShell は Windows PowerShell 5.x のままにしてる。PowerShell Core 6.0 への移行は、そのうちやろうかなって感じ。あと、Visual Studio Code は <code>code</code>で起動できるので覚えておくとよい。cmd や explorer で <code>code .\</code> ってやれば、カレントフォルダーを Visual Studio Code で開けると思う。

{{< figure src="/images/20180629183240.png"  >}}

ずは手始めにフォルダーの作成や移動を PowerShell だけでやる。統合ターミナルが使えるので、わざわざ cmd なんかを立ち上げる必要はない。PowerShell におけるファイルシステムの操作は ***-Item だけど、エイリアスがいい感じに振ってあるので、cd や ls、pwd が普通に使えていい（どんなエイリアスが降ってあるかは Get-Alias でみられる）。ただ、touch はないみたい。<code>"" > sample.ps1</code> みたいなイディオムを覚えておくといい。これは本に書いてあった。Visual Studio Code の PowerShell 拡張は大変良くできていて、PowerShell ISE よりもだいぶ強力に感じる。さっさと移行すればよかったな。

{{< figure src="/images/20180629184309.png"  >}}

りあえず自動補完。PowerShell はコマンド名が 動詞-目的語 なのでわかりやすいのだけど、その分入力はちょっとめんどいので補完があると楽。

{{< figure src="/images/20180629184425.png"  >}}

バッグ機能も ISE より使いやすいと思う。

{{< figure src="/images/20180629184504.png"  >}}

と、個人的に気に入ったのが Expand Alias 機能。エイリアスを使ってあるコードって、それを知らなかったらぱっと見わかんないんだけど、これで展開してやると馬鹿正直に書いたコードに直してくれる。

{{< figure src="/images/20180629184628.png"  >}}

 って PowerShell の習いたてだと何のことかわかんないんだけど、展開して Where-Object にすればマニュアルを調べなくても意味は分かる。結構よくない？とりあえず第1章のサンプルコードをぷちぷち打ったりして、概要をもう一度学んだ。UNIX はファイル（データ）指向、Windows は API（機能）指向。それぞれに向いた場面があるので、使い分けられるようになろう。2章以降は一回斜め読みして、必要そうなところを脳みそにインデックスしようかなって思ってる。<div class="hatena-asin-detail"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4839965986/bestylesnet-22/"><img src="https://images-fe.ssl-images-amazon.com/images/I/61pLrWCOvdL._SL160_.jpg" class="hatena-asin-detail-image" alt="PowerShell実践ガイドブック ~クロスプラットフォーム対応の次世代シェルを徹底解説~" title="PowerShell実践ガイドブック ~クロスプラットフォーム対応の次世代シェルを徹底解説~"/></a><div class="hatena-asin-detail-info"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4839965986/bestylesnet-22/">PowerShell実践ガイドブック ~クロスプラットフォーム対応の次世代シェルを徹底解説~</a><ul><li><span class="hatena-asin-detail-label">作者:</span> 吉崎生</li><li><span class="hatena-asin-detail-label">出版社/メーカー:</span> マイナビ出版</li><li><span class="hatena-asin-detail-label">発売日:</span> 2018/05/30</li><li><span class="hatena-asin-detail-label">メディア:</span> 単行本（ソフトカバー）</li><li><a href="http://d.hatena.ne.jp/asin/4839965986/bestylesnet-22" target="_blank">この商品を含むブログを見る</a></li></ul></div><div class="hatena-asin-detail-foot"></div></div>


