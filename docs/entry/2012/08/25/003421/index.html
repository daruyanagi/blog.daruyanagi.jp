
<!doctype html>
<html lang="en">
  <head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ã„ã‚ã‚†ã‚‹ã€Œã ã‚‹ã‚ãã€">
<meta name="author" content="daruyanagi">
<meta name="generator" content="Hugo">
<title>WebMatrix ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ï¼ˆ3ï¼‰ â€•â€• ãªã«ã¯ã¨ã‚‚ã‚ã‚Œãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã—ãªã„ã¨å§‹ã¾ã‚‰ã‚“ - blog.daruyanagi.jp</title>


<link href="/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">


<link rel="manifest" href="/manifest.json">
<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/favicon.ico">
<meta name="theme-color" content="#563d7c">


    
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53152247-5"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-53152247-5');
        </script>
    
<meta name="og:title"         property="og:title" content="WebMatrix ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ï¼ˆ3ï¼‰ â€•â€• ãªã«ã¯ã¨ã‚‚ã‚ã‚Œãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã—ãªã„ã¨å§‹ã¾ã‚‰ã‚“" />
    <meta name="og:site_name"     property="og:site_name" content="blog.daruyanagi.jp" />
    <meta name="og:description"   property="og:description" content="WebMatrix &#x3067;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x8A8D;&#x8A3C;&#x6A5F;&#x80FD; &#x2015;&#x2015; &#x6E96;&#x5099;&#x7DE8; - &#x3060;&#x308B;&#x308D;&#x3050; WebMatrix &#x3067;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x8A8D;&#x8A3C;&#x6A5F;&#x80FD;&#xFF08;2&#xFF09; &#x2015;&#x2015; WebSecurity&#x3063;&#x3066;&#x3069;&#x3046;&#x3084;&#x3063;&#x3066;&#x4F7F;&#x3046;&#x3093;&#x3060;&#xFF1F; - &#x3060;&#x308B;&#x308D;&#x3050; ã®ã‚“ã³ã‚Šã‚„ã£ã¦ã„ã“ã†ã€‚ä»Šå›ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã™ã‚‹ã§ã€‚ @{ var name = &quot;&quot;; var password = &quot;&quot;; var confirmPassword = &quot;&quot;; if (IsPost) { name = Request.Form[&quot;name&quot;]; password = Request.Form[&quot;password&quot;]; confirmPassword = Request.Form[&quot;confirmPassword&quot;]; // ã“ã“ã§ãƒãƒªãƒ‡ãƒ¼ã‚·" />
    
    <meta name="og:type"          property="og:type" content="article" />
    

    
    <meta name="og:image"         property="og:image" src="https://blog.daruyanagi.jp/no-image.png"  content="https://blog.daruyanagi.jp/no-image.png"  alt="">
    

    <meta name="fb:admins"        property="fb:admins" content="2150442315382" />
    <meta name="twitter:card"     property="twitter:card" content="summary" />
    <meta name="twitter:url"      property="twitter:card" content="https://blog.daruyanagi.jp/entry/2012/08/25/003421/" />
    <meta name="twitter:site"     property="twitter:card" content="@daruyanagi" />

    
    <link href="/css/styles.css" rel="stylesheet">
  
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a href="/" class="navbar-brand"><img src="/logo.png" height="30" alt=""> blog.daruyanagi.jp</a>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <span  class="navbar-text">ã„ã‚ã‚†ã‚‹ã€Œã ã‚‹ã‚ãã€</span>
                    </li>
                </ul>

            <form class="form-inline" action="/search">
                <div class="input-group">
                  <input name="q" id="q" type="text" class="form-control" spellcheck="false" data-ms-editor="true">
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Find</button>
                  </div>
                </div>
            </form>
            </div>   
        </div>
    </nav>

    <main role="main">
<article class="container" style="margin-top: 3rem;">
    <h1>WebMatrix ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ï¼ˆ3ï¼‰ â€•â€• ãªã«ã¯ã¨ã‚‚ã‚ã‚Œãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã—ãªã„ã¨å§‹ã¾ã‚‰ã‚“</h1>
    
    <p class="published text-right">
        å…¬é–‹æ—¥ï¼š<time>
            2012/08/25
        </time>        
    </p>

    <p><span itemscope itemtype="http://schema.org/Photograph"><img src="20120824233928.png" alt="f:id:daruyanagi:20120824233928p:plain" title="f:id:daruyanagi:20120824233928p:plain" class="hatena-fotolife" itemprop="image"></span><br />
</p>
<ul>
<li><a href="https://blog.daruyanagi.jp/entry/2012/08/24/095023">WebMatrix &#x3067;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x8A8D;&#x8A3C;&#x6A5F;&#x80FD; &#x2015;&#x2015; &#x6E96;&#x5099;&#x7DE8; - &#x3060;&#x308B;&#x308D;&#x3050;</a></li>
<li><a href="https://blog.daruyanagi.jp/entry/2012/08/24/105121">WebMatrix &#x3067;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x8A8D;&#x8A3C;&#x6A5F;&#x80FD;&#xFF08;2&#xFF09; &#x2015;&#x2015; WebSecurity&#x3063;&#x3066;&#x3069;&#x3046;&#x3084;&#x3063;&#x3066;&#x4F7F;&#x3046;&#x3093;&#x3060;&#xFF1F; - &#x3060;&#x308B;&#x308D;&#x3050;</a></li>
</ul><p>ã®ã‚“ã³ã‚Šã‚„ã£ã¦ã„ã“ã†ã€‚ä»Šå›ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã™ã‚‹ã§ã€‚</p>
<pre class="code lang-cs" data-lang="cs" data-unlink>@{
var name = <span class="synConstant">&quot;&quot;</span>;
var password = <span class="synConstant">&quot;&quot;</span>;
var confirmPassword = <span class="synConstant">&quot;&quot;</span>;
<p><span class="synStatement">if</span> (IsPost)
{
name = Request.Form[<span class="synConstant">&quot;name&quot;</span>];
password = Request.Form[<span class="synConstant">&quot;password&quot;</span>];
confirmPassword = Request.Form[<span class="synConstant">&quot;confirmPassword&quot;</span>];</p>
<p><span class="synComment">// ã“ã“ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå€¤ãŒå¦¥å½“ãªã‚‚ã®ã‹æ¤œè¨¼ï¼‰ã™ã‚‹</span></p>
<p><span class="synStatement">if</span> (Validation.IsValid())
{
<span class="synStatement">if</span> (WebSecurity.GetUserId(name) &gt; -<span class="synConstant">1</span>)
{
ModelState.AddFormError(<span class="synConstant">&quot;Username alredy exists&quot;</span>);
}
<span class="synStatement">else</span>
{
<span class="synStatement">try</span>
{
WebSecurity.CreateUserAndAccount(
name, password, <span class="synStatement">new</span> { Name = name });
WebSecurity.Login(name, password);
Response.Redirect(<span class="synConstant">&quot;~/&quot;</span>);
}
<span class="synStatement">catch</span> (Exception e)
{
ModelState.AddFormError(e.Message);
}
}
}
}
}
</pre><p>ã¾ãšã¯ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–¢é€£ã®è¨˜è¿°ã‚’ã¨ã£ã±ã‚‰ã£ãŸã‚µãƒ¼ãƒãƒ¼å´ã®ã‚³ãƒ¼ãƒ‰<a href="#f-8a0f6f9f" name="fn-8a0f6f9f" title="ã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ã£ã¦ã„ã†ã®ï¼Ÿã€€çŸ¥ã‚‰ã‚“ã‘ã©">*1</a>ã€‚ã‚„ã£ã¦ã„ã‚‹ã“ã¨ã¯ç°¡å˜ã§ã€</p></p>
<ol>
<li>ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å€¤ã‚’å—ã‘å–ã‚‹</li>
<li>å€¤ã‚’ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</li>
<li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ¼ãƒ ã«ãƒ€ãƒ–ã‚ŠãŒãªã„ã‹ç¢ºèª</li>
<li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ</li>
<li>ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ</li>
<li>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã‚‰é©å®œ ModelState ã«ç™»éŒ²ã—ã¦ãŠã</li>
</ol><p>ã¿ãŸã„ãªæ„Ÿã˜ã€‚</p>
<div class="section">
<h3>WebSecurity.CreateUserAndAccount()</h3>
<p>WebSecurity ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆé–‹ç™ºè€…ãŒç®¡ç†ï¼‰ã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆã‚·ã‚¹ãƒ†ãƒ ãŒç®¡ç†ï¼‰ã«ã‚ã‘ã¦ç®¡ç†ã—ã¦ã„ã‚‹ï¼ˆ<a href="https://blog.daruyanagi.jp/entry/2012/08/24/105121">WebMatrix &#x3067;&#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x8A8D;&#x8A3C;&#x6A5F;&#x80FD;&#xFF08;2&#xFF09; &#x2015;&#x2015; WebSecurity&#x3063;&#x3066;&#x3069;&#x3046;&#x3084;&#x3063;&#x3066;&#x4F7F;&#x3046;&#x3093;&#x3060;&#xFF1F; - &#x3060;&#x308B;&#x308D;&#x3050;</a>ï¼‰ã€‚ä¸¡è€…ã¯åŒã˜ UserId ã§ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ä»•çµ„ã¿ã ã€‚ </p><p>WebSecurity.CreateUserAndAccount() ã¯ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆã‚’åŒæ™‚ã«è¡Œã†ãƒ¡ã‚½ãƒƒãƒ‰ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒ¿å…¥ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ã€ç¬¬ä¸‰å¼•æ•°ã§åŒ¿åã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¸ãˆã‚Œã°ã‚ˆã„ã€‚ä»Šå›ã¯åå‰ã ã‘ã‚’ç™»éŒ²ã—ã¦ãŠã„ãŸã€‚</p><p>ã¡ãªã¿ã« WebSecurity.Create() ã ã‘ã‚’ä½¿ã£ãŸå ´åˆã€ã•ãã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ UserId ã¨ãã®ã»ã‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã—ã¦ãŠã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚â€œStarter Siteâ€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã¯ãã‚Œã‚’ SQL ã§è¡Œãªã£ã¦ã„ã‚‹ã€‚</p>
<pre class="code lang-cs" data-lang="cs" data-unlink><span class="synStatement">if</span> (Validation.IsValid())
{
var db = Database.Open(App.Database);
<p>var user = db.QuerySingle(
<span class="synConstant">&quot;SELECT Name FROM Users WHERE LOWER(Name) = LOWER(@0)&quot;</span>,
name);</p>
<p><span class="synStatement">if</span> (user == <span class="synConstant">null</span>)
{
db.Execute(
<span class="synConstant">&quot;INSERT INTO Users (Name) VALUES (@0)&quot;</span>, name);
WebSecurity.CreateAccount(name, password);
</pre><p>ã’ã‚ã’ã‚ã†ã’ãƒ¼ã€‚</p></p>
<pre class="code lang-cs" data-lang="cs" data-unlink><span class="synStatement">if</span> (Validation.IsValid())
{
<span class="synStatement">if</span> (WebSecurity.GetUserId(name) &gt; -<span class="synConstant">1</span>)
{
ModelState.AddFormError(<span class="synConstant">&quot;Username alredy exists&quot;</span>);
}
<span class="synStatement">else</span>
{
<span class="synStatement">try</span>
{
WebSecurity.CreateUserAndAccount(
name, password, <span class="synStatement">new</span> { Name = name });
</pre><p>çµ¶å¯¾ã“ã£ã¡ã«ã™ã‚‹ã‚„ã‚ã€‚ã›ã£ã‹ã WebSecurity Helper ã‚’ä½¿ã†ã‚“ã ã‹ã‚‰ã€å¤§ã„ã«é ¼ã‚Œã°ã‚ˆã‚ã—ã„ã€‚</p><p><span itemscope itemtype="http://schema.org/Photograph"><img src="20120825001002.png" alt="f:id:daruyanagi:20120825001002p:plain" title="f:id:daruyanagi:20120825001002p:plain" class="hatena-fotolife" itemprop="image"></span><br />
</p>
</div>
<div class="section">
<h3>ModelState</h3>
<p>ModelState ã¯ WebPage ã«å±ã—ã¦ãŠã‚Šã€ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¨ãƒ©ãƒ¼ã‚’ç®¡ç†ã™ã‚‹ã‚‚ã®ã ã¨ã§ã‚‚ç†è§£ã—ã¦ãŠãã€‚ ModelState.AddFormError() ã§ãƒ•ã‚©ãƒ¼ãƒ é–¢é€£ã®ã‚¨ãƒ©ãƒ¼ãŒç™»éŒ²ã§ãã‚‹ã‚“ã ãªã€‚</p><p>ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é–¢é€£ã®ã‚³ãƒ¼ãƒ‰ã¯ã“ã‚“ãªæ„Ÿã˜ï¼ˆâ€œStarter Siteâ€ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‘ã‚¯ã£ã¦ããŸï¼‰ã€‚</p>
<pre class="code lang-cs" data-lang="cs" data-unlink>Validation.RequireField(<span class="synConstant">&quot;name&quot;</span>,
<span class="synConstant">&quot;é›»å­ãƒ¡ãƒ¼ãƒ« ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚&quot;</span>);
Validation.RequireField(<span class="synConstant">&quot;password&quot;</span>,
<span class="synConstant">&quot;ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç©ºç™½ã«ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚&quot;</span>);
Validation.Add(<span class="synConstant">&quot;confirmPassword&quot;</span>,ã€€Validator.EqualsTo(
<span class="synConstant">&quot;password&quot;</span>, <span class="synConstant">&quot;ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ç¢ºèªã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“ã€‚&quot;</span>)
);
Validation.Add(<span class="synConstant">&quot;password&quot;</span>,
Validator.StringLength(
<span class="synStatement">        maxLength:</span> Int32.MaxValue,
<span class="synStatement">        minLength:</span> <span class="synConstant">6</span>,
<span class="synStatement">        errorMessage:</span> <span class="synConstant">&quot;ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ 6 æ–‡å­—ä»¥ä¸Šã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™&quot;</span>
)
);
</pre><p>èª­ã‚€ã ã‘ã§ä½•ã‚’ã—ã¦ã„ã‚‹ã®ã‹ã‚ã‹ã‚‹ã®ãŒã„ã„ã€‚è¡¨ç¤ºéƒ¨åˆ†ã¯ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ãŸã€‚</p>
<pre class="code lang-cs" data-lang="cs" data-unlink>&lt;section id=<span class="synConstant">&quot;register&quot;</span>&gt;
&lt;form method=<span class="synConstant">&quot;post&quot;</span>&gt;
@Html.ValidationSummary(<span class="synConstant">&quot;Log in was unsuccessful.&quot;</span> +
<span class="synConstant">&quot;Please correct the errors and try again.&quot;</span>,
<span class="synStatement">            excludeFieldErrors:</span> <span class="synConstant">true</span>, htmlAttributes: <span class="synConstant">null</span>)
<p>&lt;fieldset&gt;
&lt;legend&gt;Register Your Account&lt;/legend&gt;
&lt;ol&gt;
@RenderFormInputWithValidation(<span class="synStatement">this</span>, <span class="synConstant">&quot;name&quot;</span>)
&lt;li <span class="synType">class</span>=<span class="synConstant">&quot;name&quot;</span>&gt;
&lt;label <span class="synStatement">for</span>=<span class="synConstant">&quot;name&quot;</span> @<span class="synStatement">if</span> (!ModelState.IsValidField(<span class="synConstant">&quot;name&quot;</span>)) {&lt;text&gt;<span class="synType">class</span>=<span class="synConstant">&quot;error-label&quot;</span>&lt;/text&gt;}&gt;Name&lt;/label&gt;
&lt;input type=<span class="synConstant">&quot;text&quot;</span>
id=<span class="synConstant">&quot;name&quot;</span> name=<span class="synConstant">&quot;name&quot;</span> <span class="synStatement">value</span>=<span class="synConstant">&quot;@name&quot;</span>
@Validation.For(<span class="synConstant">&quot;name&quot;</span>) /&gt;
@Html.ValidationMessage(<span class="synConstant">&quot;name&quot;</span>)
&lt;/li&gt;
&lt;li <span class="synType">class</span>=<span class="synConstant">&quot;password&quot;</span>&gt;
&lt;label <span class="synStatement">for</span>=<span class="synConstant">&quot;password&quot;</span> @<span class="synStatement">if</span> (!ModelState.IsValidField(<span class="synConstant">&quot;password&quot;</span>)) {&lt;text&gt;<span class="synType">class</span>=<span class="synConstant">&quot;error-label&quot;</span>&lt;/text&gt;}&gt;Password&lt;/label&gt;
&lt;input type=<span class="synConstant">&quot;password&quot;</span>
id=<span class="synConstant">&quot;password&quot;</span> name=<span class="synConstant">&quot;password&quot;</span>
@Validation.For(<span class="synConstant">&quot;password&quot;</span>)/&gt;
@Html.ValidationMessage(<span class="synConstant">&quot;password&quot;</span>)
&lt;/li&gt;
&lt;li <span class="synType">class</span>=<span class="synConstant">&quot;confirm-password&quot;</span>&gt;
&lt;label <span class="synStatement">for</span>=<span class="synConstant">&quot;confirm-password&quot;</span> @<span class="synStatement">if</span> (!ModelState.IsValidField(<span class="synConstant">&quot;confirmPassword&quot;</span>)) {&lt;text&gt;<span class="synType">class</span>=<span class="synConstant">&quot;error-label&quot;</span>&lt;/text&gt;}&gt;confirmPassword&lt;/label&gt;
&lt;input type=<span class="synConstant">&quot;password&quot;</span>
id=<span class="synConstant">&quot;confirmPassword&quot;</span> name=<span class="synConstant">&quot;confirmPassword&quot;</span>
@Validation.For(<span class="synConstant">&quot;confirmPassword&quot;</span>)/&gt;</p>
<p>@Html.ValidationMessage(<span class="synConstant">&quot;confirmPassword&quot;</span>)
&lt;/li&gt;
&lt;/ol&gt;
&lt;input type=<span class="synConstant">&quot;submit&quot;</span> <span class="synStatement">value</span>=<span class="synConstant">&quot;Register&quot;</span> /&gt;
&lt;/fieldset&gt;
&lt;/form&gt;
&lt;/section&gt;
</pre><p>ãã¡ã‚ƒãã¡ã‚ƒã—ã¦ã‚ã‹ã‚Šã«ãã„ãŒã€</p></p>
<pre class="code lang-cs" data-lang="cs" data-unlink>@Html.ValidationSummary(<span class="synConstant">&quot;Log in was unsuccessful.&quot;</span> +
<span class="synConstant">&quot;Please correct the errors and try again.&quot;</span>,
<span class="synStatement">    excludeFieldErrors:</span> <span class="synConstant">true</span>, htmlAttributes: <span class="synConstant">null</span>)
</pre><p>ã§ãƒšãƒ¼ã‚¸å…¨ä½“ã«ã¤ã„ã¦ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³çµæœã‚’è¡¨ç¤ºã™ã‚‹ã€‚</p><p><span itemscope itemtype="http://schema.org/Photograph"><img src="20120825002435.png" alt="f:id:daruyanagi:20120825002435p:plain" title="f:id:daruyanagi:20120825002435p:plain" class="hatena-fotolife" itemprop="image"></span></p><p>ãƒ•ã‚©ãƒ¼ãƒ ã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã€</p>
<pre class="code lang-cs" data-lang="cs" data-unlink>&lt;label <span class="synStatement">for</span>=<span class="synConstant">&quot;name&quot;</span> @<span class="synStatement">if</span> (!ModelState.IsValidField(<span class="synConstant">&quot;name&quot;</span>)) {&lt;text&gt;<span class="synType">class</span>=<span class="synConstant">&quot;error-label&quot;</span>&lt;/text&gt;}&gt;Name&lt;/label&gt;
&lt;input type=<span class="synConstant">&quot;text&quot;</span> id=<span class="synConstant">&quot;name&quot;</span> name=<span class="synConstant">&quot;name&quot;</span> <span class="synStatement">value</span>=<span class="synConstant">&quot;@name&quot;</span> @Validation.For(<span class="synConstant">&quot;name&quot;</span>) /&gt;
@Html.ValidationMessage(<span class="synConstant">&quot;name&quot;</span>)
</pre><p>ã“ã®ã‚³ãƒ¼ãƒ‰ã§ãƒ¯ãƒ³ã‚»ãƒƒãƒˆã¿ãŸã„ã€‚ Validation.For() ã¯ JavaScript ã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«å¿…è¦ãª data- å±æ€§ã‚’å‡ºåŠ›ã™ã‚‹ï¼ˆä»Šå›ã¯ä½¿ã£ã¦ãªã„ï¼‰ã€‚ Html.ValidationMessage() ã¯ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Œã°è¡¨ç¤ºã™ã‚‹ã€‚ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã•ã£ã ModelState ã«ç™»éŒ²ã—ãŸã‚¨ãƒ©ãƒ¼ã‹ã‚‰å–å¾—ã™ã‚‹ã¿ãŸã„ã€‚</p><p><span itemscope itemtype="http://schema.org/Photograph"><img src="20120825002611.png" alt="f:id:daruyanagi:20120825002611p:plain" title="f:id:daruyanagi:20120825002611p:plain" class="hatena-fotolife" itemprop="image"></span></p><p>å¾Œè€…ã®ã‚³ãƒ¼ãƒ‰ã¯ä½¿ã„ã¾ã‚ã›ãã†ãªã„ã‚ã°ã‚¤ãƒ‡ã‚£ã‚ªãƒ ãªã®ã§ã€ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‹æ‹¡å¼µãƒ¡ã‚½ãƒƒãƒ‰ã«ã—ã¦ãŠãã¨ã‚ˆã•ãã†ã ã€‚ä»Šå›ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ã¿ãŸã‚ˆã€‚</p>
<pre class="code lang-cs" data-lang="cs" data-unlink>~/App_Code/WebPageExtension.cs

<span class="synStatement">using</span> System.Linq;
<span class="synStatement">using</span> System.Web;
<span class="synStatement">using</span> System.Web.WebPages;
<span class="synStatement">using</span> System.Web.WebPages.Html;

<span class="synType">public</span> <span class="synType">static</span> <span class="synType">class</span> WebPageExtension
{
<span class="synType">private</span> <span class="synType">enum</span> InputType
{
Text, Password, Checkbox, Textarea,
}

<span class="synType">private</span> <span class="synType">static</span> HtmlString RenderInputWithValidation(
<span class="synStatement">this</span> WebPage target, InputType input_type,
<span class="synType">string</span> name, <span class="synType">string</span> label = <span class="synConstant">&quot;&quot;</span>, <span class="synType">object</span> additional = <span class="synConstant">null</span>)
{
<span class="synType">const</span> <span class="synType">string</span> HTML_TAG = <span class="synSpecial">@</span><span class="synConstant">&quot;</span>
<span class="synConstant">            &lt;div class=&quot;&quot;validation-input {0} {1}&quot;&quot;&gt;</span>
<span class="synConstant">                &lt;label for=&quot;&quot;{0}&quot;&quot;&gt;{2}&lt;/label&gt;</span>
<span class="synConstant">                &lt;input type=&quot;&quot;{3}&quot;&quot; id=&quot;&quot;{0}&quot;&quot; name=&quot;&quot;{0}&quot;&quot; {4} {5} /&gt;</span>
<span class="synConstant">                {6}</span>
<span class="synConstant">            &lt;/div&gt;&quot;</span>;

var attrs = (additional == <span class="synConstant">null</span>)
? <span class="synType">string</span>.Empty
: <span class="synType">string</span>.Join(<span class="synConstant">&quot; &quot;</span>, additional
.GetType()
.GetProperties()
.Select((p) =&gt; <span class="synType">string</span>
.Format(<span class="synConstant">&quot;{0}=</span><span class="synSpecial">\&quot;</span><span class="synConstant">{1}</span><span class="synSpecial">\&quot;</span><span class="synConstant">&quot;</span>,
p.Name.ToLower(),
p.GetValue(additional)
)
)
);

<span class="synStatement">return</span> <span class="synStatement">new</span> HtmlString(
<span class="synType">string</span>.Format(
HTML_TAG, name,
target.ModelState.IsValidField(name)
? <span class="synType">string</span>.Empty
: <span class="synConstant">&quot;validation-failed&quot;</span>,
label.IsEmpty() ? name : label,
input_type.ToString().ToLower(),
attrs,
target.Validation.For(name),
target.Html.ValidationMessage(name)
)
);
}

<span class="synType">public</span> <span class="synType">static</span> HtmlString RenderTextWithValidation(
<span class="synStatement">this</span> WebPage target, <span class="synType">string</span> name,
<span class="synType">string</span> label = <span class="synConstant">null</span>, <span class="synType">object</span> additional = <span class="synConstant">null</span>)
{
<span class="synStatement">return</span> RenderInputWithValidation(
target, InputType.Text, name, label, additional);
}

<span class="synType">public</span> <span class="synType">static</span> HtmlString RenderPasswordWithValidation(
<span class="synStatement">this</span> WebPage target, <span class="synType">string</span> name,
<span class="synType">string</span> label = <span class="synConstant">null</span>, <span class="synType">object</span> additional = <span class="synConstant">null</span>)
{
<span class="synStatement">return</span> RenderInputWithValidation(
target, InputType.Password, name, label, additional);
}

<span class="synType">public</span> <span class="synType">static</span> HtmlString RenderCheckBoxWithValidation(
<span class="synStatement">this</span> WebPage target, <span class="synType">string</span> name,
<span class="synType">string</span> label = <span class="synConstant">null</span>, <span class="synType">object</span> additional = <span class="synConstant">null</span>)
{
<span class="synStatement">return</span> RenderInputWithValidation(
target, InputType.Checkbox, name, label, additional);
}
}
</pre><p>ModelState ãŒ WebPage ã«å±ã™ã‚‹é–¢ä¿‚ã§ã€ WebPage ã‚¯ãƒ©ã‚¹ã®æ‹¡å¼µãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦å®šç¾©ã—ã¦ã‚ã‚‹ã€‚ã»ã‚“ã¨ã¯ HTML Helper ã«ã—ã¦ã€ @Html.TextWithValidation() ãªã©ã¨å‘¼ã¹ã‚‹æ–¹ãŒã‚«ãƒƒã‚³ã„ã„ãªã€‚ä»Šåº¦ã‚‚ã†å°‘ã—ã“ã®ã‚ãŸã‚Šã¯ãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ãƒƒãƒ—ã—ã¦ã¿ãŸã„ã€‚</p><p>ã‚“ã§ã€ã“ã‚Œã‚’ä½¿ã£ã¦æ›¸ããªãŠã—ãŸè¡¨ç¤ºéƒ¨åˆ†ã¯ã“ã†ãªã‚‹ã€‚</p>
<pre class="code lang-cs" data-lang="cs" data-unlink>&lt;section id=<span class="synConstant">&quot;register&quot;</span>&gt;
&lt;form method=<span class="synConstant">&quot;post&quot;</span>&gt;
@Html.ValidationSummary(
<span class="synConstant">&quot;Log in was unsuccessful.&quot;</span> +
<span class="synConstant">&quot;Please correct the errors and try again.&quot;</span>,
<span class="synConstant">false</span>, <span class="synConstant">null</span>)

&lt;fieldset&gt;
&lt;legend&gt;Register Your Account&lt;/legend&gt;
@<span class="synStatement">this</span>.RenderTextWithValidation(
<span class="synConstant">&quot;name&quot;</span>, <span class="synConstant">&quot;Name&quot;</span>, <span class="synStatement">new</span> { Value = name} )
@<span class="synStatement">this</span>.RenderPasswordWithValidation(
<span class="synConstant">&quot;password&quot;</span>, <span class="synConstant">&quot;Password&quot;</span>)
@<span class="synStatement">this</span>.RenderPasswordWithValidation(
<span class="synConstant">&quot;confirmPassword&quot;</span>, <span class="synConstant">&quot;Confirm Password&quot;</span>)
&lt;input type=<span class="synConstant">&quot;submit&quot;</span> <span class="synStatement">value</span>=<span class="synConstant">&quot;Register&quot;</span> /&gt;
&lt;/fieldset&gt;
&lt;/form&gt;
&lt;/section&gt;
</pre><p>ã ã„ã¶ã‚·ãƒ³ãƒ—ãƒ«ã«ãªã£ã¦äºˆã¯ã ã„ã¶æº€è¶³ã—ãŸãã‚ˆã€‚ã»ã‹ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã®çœŸä¼¼ã—ã¦ new { Value = name} ã§è¿½åŠ ã®å±æ€§ã‚’è¿½åŠ ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã¿ãŸã®ãŒã¡ã‚‡ã£ã¨ã ã‘è‡ªæ…¢ã ã€‚ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯ã¡ã‚‡ã£ã¨è‹¦æ‰‹ãªã®ã§ã€ä»Šæ—¥ã¯å€‹äººçš„ã«ãã®å‹‰å¼·ãªã©ã—ã¦ã¿ãŸã€‚</p><p>æ¬¡å›ã¯ãƒ­ã‚°ã‚¤ãƒ³ã¨ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã ã‘ã©ã€ã“ã‚Œã¯ä¸€ç¬ã§çµ‚ã‚ã‚Šãã†â€¦â€¦ã€‚</p>
</div><div class="footnote">
<p class="footnote"><a href="#fn-8a0f6f9f" name="f-8a0f6f9f" class="footnote-number">*1</a><span class="footnote-delimiter">:</span><span class="footnote-text">ã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ã£ã¦ã„ã†ã®ï¼Ÿã€€çŸ¥ã‚‰ã‚“ã‘ã©</span></p>
</div>

    <footer>
        
        

        
            <p class="text-right">
                <a href="https://github.com/daruyanagi/blog.daruyanagi.jp/tree/master/content/entry/2012/08/25/003421.md"><img src="https://github.com/favicon.ico" style="height: 16px; vertical-align: middle;"> View on GitHub.com</a>
                / 
                æœ€çµ‚æ›´æ–°æ—¥ï¼š<time>2020/05/04</time> 
            </p>
        
    </footer>
</article>

<section class="container text-center"> 

    <p>
        
        <a href="https://blog.daruyanagi.jp/entry/2012/08/24/105121/">&laquo; Older</a>
        
        <span > - </span>
            <a href="/">ğŸ  Home</a>
        <span > - </span>
        
            <a href="https://blog.daruyanagi.jp/entry/2012/08/26/114129/">Newer &raquo;</a>
        
    </p>    
    
</section>


    </main>

    <footer class="text-muted"></footer><div class="container">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block; text-align:center;"
         data-ad-layout="in-article"
         data-ad-format="fluid"
         data-ad-client="ca-pub-0944887782985208"
         data-ad-slot="1125180844"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <div class="spacer" style="height: 3rem;"></div>

    <p class="float-right">
    <a href="#">Back to top</a>
    </p>
    <p>
        &copy; <a href="//daruyanagi.jp">daruyanagi</a> 2007-2020. </p>
</div>

</footer>

    <script src="//code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script></body>

    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=sunburst"></script>

    <script>
      const pres = document.getElementsByTagName("pre");
      for (var i = 0; i < pres.length; i++)
      {
        pres[i].classList.add("prettyprint");
        
      }

      const tables = document.getElementsByTagName("table");
      for (var i = 0; i < tables.length; i++)
      {
        tables[i].classList.add("table");
      }

      const blockquotes = document.getElementsByTagName("blockquote");
      for (var i = 0; i < blockquotes.length; i++)
      {
        blockquotes[i].classList.add("blockquote");
      }
    </script>
</html>
