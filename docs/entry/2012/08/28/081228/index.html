<!DOCTYPE html>
<html><link rel="icon" href="https://via.placeholder.com/70x70">
<link rel="stylesheet" href="https://andybrewer.github.io/mvp/mvp.css">

<meta charset="utf-8">
<meta name="description" content="My description">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>寄り道 - だるろぐ - だるやなぎのブログ</title>

<style>
    nav {
        margin-bottom: 0;
    }

    body {
        font-family: "UD デジタル 教科書体 NP-R", Arial, Helvetica, sans-serif;
    }

    table {
        margin: 2em auto;
        border: none;
    }

    th, td, tr {
        text-align: right !important;
        padding: 1rem !important;
    }

    td {
        border-bottom: 1px solid gray;
    }
</style>


    
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-53152247-5"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-53152247-5');
        </script>
    
<body>
        <header><nav>
    <a href="/"><img alt="Logo" src="/logo.png" height="70"></a>
    
</nav>

<h1>だるろぐ - だるやなぎのブログ</h1>

<p></p>



<hr></header>

        <main>
<article>
    <h1>寄り道</h1>
    
    <p class="published">
        <time>
            公開日：
            2012/08/28
        </time>        
    </p>

    <p><a href="https://blog.daruyanagi.jp/entry/2012/08/25/003421">WebMatrix でユーザー認証機能（3） ―― なにはともあれユーザー登録しないと始まらん - だるろぐ</a> の脱線。個人的には</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&amp;lt;fieldset&gt;
    &amp;lt;legend&gt;Register Your Account&amp;lt;/legend&gt;
    @this.RenderTextWithValidation(
        &#34;name&#34;, &#34;Name&#34;, new { Value = name} )
    @this.RenderPasswordWithValidation(
        &#34;password&#34;, &#34;Password&#34;)
    @this.RenderPasswordWithValidation(
        &#34;confirmPassword&#34;, &#34;Confirm Password&#34;)
    &amp;lt;input type=&#34;submit&#34; value=&#34;Register&#34; /&gt;
&amp;lt;/fieldset&gt;

```って書くのがイケてない。「&#34;password&#34;, &#34;Password&#34;」だの、「&#34;confirmPassword&#34;, &#34;Confirm Password&#34;」だの、おんなじこと二回も書きたくないじゃん。あと、 HTML 要素の class や id は勝手にハイフン区切りにしてほしい。 Ruby on Rails にはソレ系のユーティリティが用意されているので楽なんだけどな（ActiveSupport）。まぁ、なければ作れって話だ。まず、あると便利な拡張メソッドを作っていく。先頭を大文字、後を小文字にする Capitalize() は欲しいよね。
```cs
public static string Capitalize(this string target)
{
    return target.Length &gt; 1
        ? char.ToUpper(target[0]) +
          target.Substring(1, target.Length - 1).ToLower()
        : target.ToUpper();
}

```char.ToUpper() を &amp;#39;a&amp;#39;.ToUpper() にしたいが今日のところは面倒なので許してやろう。さぁ、どんどん作っていくよ！　つぎは痴漢系、もとい置換系だな。 C# （.NET Framework）ってちょっと文字列操作系のメソッドが充実してもいいと思う。
```cs
public static string Gsub(
    this string target, Regex r, string replacement)
{
    return r.Replace(target, replacement);
}

public static string Gsub(
    this string target, Regex r, MatchEvaluator m)
{
    return r.Replace(target, m);
}

public static string Gsub(
    this string target, string pattern, string replacement)
{
    return target.Gsub(new Regex(pattern), replacement);
}

public static string Gsub(
    this string target, string pattern, MatchEvaluator m)
{
    return target.Gsub(new Regex(pattern), m);
}

```これの何が便利かというと、
```cs
public static string Underscore(this string target)
{
    // 空白やハイフンをアンダースコアに置き換える
    return target.Gsub(@&#34;[ 　-]&#34;, &#34;_&#34;);
}

```みたいに使える。 string.Replace() みたいに手軽で、それでいて強力！　場合によっては、第一引数に正規表現を渡してもいいし、第二引数で Match を引数にとったラムダを使ってもいい。ホントのことを言えば C# にも正規表現リテラルがあると嬉しいのだけれどね……
```cs
private static string DivideIntoWords(
    this string target, string separator = &#34; &#34;)
{
    return target.Gsub(
        @&#34;([\w-[A-Z]])([A-Z])&#34;,
        string.Format(&#34;$1{0}$2&#34;, separator)
    );
}

```あと、こんなのも作ってみた。これは「HelloWorld」を「Hello World」に分割する。第二引数を渡せば、「Hello_World」や「Hello-World」も作れる。こいつらを使って、 PascalCase （UpperCamelCase）に変換する拡張メソッドを作ってみよう。
```cs
static readonly char[] SPACE_AND_DELIMITTER = &#34; 　-_&#34;.ToArray();

public static string ToPascalCase(this string target)
{
    return target                    // sampleText_is-Cool
        .DivideIntoWords()           // sample Text_is-Cool
        .Split(SPACE_AND_DELIMITTER) // { sample, Text, is, Cool }
        .Select(_ =&gt; _.Capitalize()) // { Sample, Text, Is, Cool }
        .Combine();                  // SampleTextIsCool
}

public static string ToUpperCamelCase(this string target)
{
    return target.ToPascalCase();
}

private static string Combine(
    this IEnumerable&amp;lt;string&gt; target, string separator = &#34;&#34;)
{
    return string.Join(separator, target.ToArray());
}

```Combine() はメソッドチェーンを切らずに string.Join() したいので作った IEnumerable&amp;lt;string&gt; の拡張メソッドで、@xin9le さんが命名してくれた。同様にして CamelCase（LowerCamelCase）も作れる。
```cs
public static string Camelize(this string target)
{
    return target
        .DivideIntoWords()
        .Split(SPACE_AND_DELIMITTER_CHARS)
        .Select((_, i) =&gt; (i == 0) // &amp;lt;-- カウンターを使う
            ? _.ToLower()
            : _.Capitalize())
        .Combine();
}

```1回目（i == 0）のときだけ ToLower()、あとはさっき作った Capitalize() すればいいね。今まで知らなかったのだけれど、 Enumerable.Select(Func&amp;lt;TSource, Int32, TResult&gt;) （&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://msdn.microsoft.com/ja-jp/library/bb534869&#34;</span>&gt;http://msdn.microsoft.com/ja-jp/library/bb534869&lt;/<span style="color:#f92672">a</span>&gt;）を使うと「今何回目の処理をしているか（インデックス）」が取得できるのね。 Ruby の map {|i| ... } みたいなものかな。
```cs
public static string Titlize(this string target)
{
    return target
        .Gsub(@&#34;[_-]&#34;, &#34; &#34;)
        .DivideIntoWords()
        .Split(SPACE_AND_DELIMITTER)
        .Select(_ =&gt; _.Capitalize())
        .Combine(&#34; &#34;);
}

public static string Humanize(this string target)
{
    return target
        .Gsub(@&#34;[_-]&#34;, &#34; &#34;)
        .DivideIntoWords()
        .Split(SPACE_AND_DELIMITTER)
        .Select((_, i) =&gt; (i == 0) ? _.Capitalize() : _.ToLower())
        .Combine(&#34; &#34;);
}

```あとは僕の望みの、Titlize() や Humanize() も作ってみた。メソッド名は ActiveSupport から拝借。

<figure>
    <img src="/images/20120828080159.png"/> 
</figure>


br/&gt;

</code></pre></div><p>&ldquo;man from the boondocks&rdquo;.Titlize()   # =&gt; &ldquo;Man From The Boondocks&rdquo;
&ldquo;man from the boondocks&rdquo;.Humanize()  # =&gt; &ldquo;Man from the boondocks&rdquo;</p>
<p>&ldquo;x-men: the last stand&rdquo;.Titlize()    # =&gt; &ldquo;X Men: The Last Stand&rdquo;
&ldquo;x-men: the last stand&rdquo;.Humanize()   # =&gt; &ldquo;X men: the last stand&rdquo;</p>
<p>&ldquo;TheManWithoutAPast&rdquo;.Titlize()       # =&gt; &ldquo;The Man Without A Past&rdquo;
&ldquo;TheManWithoutAPast&rdquo;.Humanize()      # =&gt; &ldquo;The man without a past&rdquo;</p>
<p>&ldquo;raiders_of_the_lost_ark&rdquo;.Titlize()  # =&gt; &ldquo;Raiders Of The Lost Ark&rdquo;
&ldquo;raiders_of_the_lost_ark&rdquo;.Humanize() # =&gt; &ldquo;Raiders of the lost ark&rdquo;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-CSS" data-lang="CSS">

</code></pre></div>
</article>

<section>
    <style>
        article p.published { text-align: right; }

        .spacer { margin: auto 1em;}
    </style>

    <p>
        
        <a href="https://blog.daruyanagi.jp/entry/2012/08/27/000929/">&laquo; Older</a>
        
        <span class="spacer">|</span>
        <a href="/">Home</a>
        <span class="spacer">|</span>
        <a href="#">Top</a>
        <span class="spacer">|</span>
        
            <a href="https://blog.daruyanagi.jp/entry/2012/08/28/191129/">Newer &raquo;</a>
        
    </p>    
    
</section>


        </main>
        
        <footer><hr>
<p>
    <a href="/about">daruyanagi</a> &copy; 2007-2020
</p></footer>
    </body>
</html>
