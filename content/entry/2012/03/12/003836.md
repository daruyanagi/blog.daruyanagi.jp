
+++
date = "2012-03-12 00:38:36 +0000 UTC"
draft = false
title = "WPFでバージョン情報ダイアログをつくる"
tags = ["C#","WPF"]

+++
VisualBasic では My.Aoolication.Info でバージョン情報なんかを簡単に取得できるらしい。これを使えば簡単にバージョン情報ダイアログを実装できそうだな。これを C# から使ってみよう。<a href="http://msdn.microsoft.com/ja-jp/library/0f1ec0yf(v=vs.80).aspx">http://msdn.microsoft.com/ja-jp/library/0f1ec0yf(v=vs.80).aspx</a>Microsoft.VisualBasic を参照に追加して、using してあげる。そして、Loaded イベントで DataContext に AssemblyInfo オブジェクトを割り当ててあげる。

    ```
using Microsoft.VisualBasic.ApplicationServices;

namespace Type08ScreenCapture
{
    /// &lt;summary>
    /// MainWindow.xaml の相互作用ロジック
    /// &lt;/summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void Window_Loaded(
            object sender, RoutedEventArgs e)
        {
            DataContext = new AssemblyInfo(
               System.Reflection.Assembly.GetExecutingAssembly());
        }
：
：
```
あとは XAML 側でバインディングしていく。<img src="http://cdn-ak.f.st-hatena.com/images/fotolife/d/daruyanagi/20120312/20120312003119.png" alt="f:id:daruyanagi:20120312003119p:plain" title="f:id:daruyanagi:20120312003119p:plain" class="hatena-fotolife"/>

    ```
&lt;TextBlock Margin="24" Text="{Binding ProductName}" />
```
バインディングヒャッホイ！<a href="http://daruyanagi.hatenablog.com/entry/2012/03/11/165757">「08式机上撮影機（Type08ScreenCapture）」を公開しました - だるろぐ</a> で使ってみたのだけど、WinForm のコードよりもすっきりしていていい感じだ。


