
+++
date = "2014-08-16 21:16:10 +0000 UTC"
draft = false
title = "WinRT"
tags = ["WinRT"]

+++
{{< figure src="/images/20140816205113.png"  >}}<br/>


    >
        COM コンポーネントを表す型のインターフェイスを COM コンポーネントを表さない型にキャストすることはできません。

    
{{< figure src="/images/20140816210519.png"  >}}なんかこんな感じの、まぁ、自分でもよくわからん感じの設計になっていたのだけど、ShareTargetPage の ViewModel でエラーが発生する。問題のコードはこの部分。
```cs
protected void OnPropertyChanged([CallerMemberName] string propertyName = null)
{
    var eventHandler = this.PropertyChanged;
    if (eventHandler != null)
    {
        eventHandler(this, new PropertyChangedEventArgs(propertyName));
    }
}

```ここで InvalidCastException が出る……。<a href="http://okazuki.hatenablog.com/entries/2012/10/13">かずきのBlog@hatena</a> ともちょっと違うのだけど、どうせ似たような原因だと思う。

    >
        結果として別スレッドでコレクションを操作したため、エラーになるというWPFやSilverlightなどでおなじみのエラーパターンと同じでした。それにしても、何故InvalidCastExceptionなのだ！！

    
いろいろ試してみたが、結局、自分の場合は Visual Studio でデバッグ実行しているときだけ発生することが判明（？）。共有のテストをするときはデバッグ実行したアプリを終了してから行うという手段で回避できた。いつか根本的に解決できるようになりたいです（小並


